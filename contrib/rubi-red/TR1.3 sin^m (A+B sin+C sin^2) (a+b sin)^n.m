(* ::Package:: *)

(************************************************************************)
(* This file was generated automatically by the Mathematica front end.  *)
(* It contains Initialization cells from a Notebook file, which         *)
(* typically will have the same name as this file except ending in      *)
(* ".nb" instead of ".m".                                               *)
(*                                                                      *)
(* This file is intended to be loaded into the Mathematica kernel using *)
(* the package loading commands Get or Needs.  Doing so is equivalent   *)
(* to using the Evaluate Initialization Cells menu command in the front *)
(* end.                                                                 *)
(*                                                                      *)
(* DO NOT EDIT THIS FILE.  This entire file is regenerated              *)
(* automatically each time the parent Notebook file is saved in the     *)
(* Mathematica front end.  Any changes you make to this file will be    *)
(* overwritten.                                                         *)
(************************************************************************)



(* ::Code:: *)
Int[(B_.*sin[c_.+d_.*x_]+C_.*sin[c_.+d_.*x_]^2)*(a_.+b_.*sin[c_.+d_.*x_])^n_.,x_Symbol] :=
  Int[Sin[c+d*x]*(B+C*Sin[c+d*x])*(a+b*Sin[c+d*x])^n,x] /;
FreeQ[{a,b,c,d,B,C,n},x]


(* ::Code:: *)
Int[sin[c_.+d_.*x_]^m_.*(B_.*sin[c_.+d_.*x_]+C_.*sin[c_.+d_.*x_]^2)*(a_.+b_.*sin[c_.+d_.*x_])^n_.,x_Symbol] :=
  Int[Sin[c+d*x]^(m+1)*(B+C*Sin[c+d*x])*(a+b*Sin[c+d*x])^n,x] /;
FreeQ[{a,b,c,d,B,C,m,n},x]


(* ::Code:: *)
Int[(A_+C_.*sin[c_.+d_.*x_]^2)*(b_.*sin[c_.+d_.*x_])^n_.,x_Symbol] :=
  A*Cos[c+d*x]*(b*Sin[c+d*x])^(n+1)/(b*d*(n+1)) /;
FreeQ[{b,c,d,A,C,n},x] && ZeroQ[C*(n+1)+A*(n+2)]


(* ::Code:: *)
Int[(A_+C_.*sin[c_.+d_.*x_]^2)*(b_.*sin[c_.+d_.*x_])^n_,x_Symbol] :=
  A*Cos[c+d*x]*(b*Sin[c+d*x])^(n+1)/(b*d*(n+1)) + 
  (C*(n+1)+A*(n+2))/(b^2*(n+1))*Int[(b*Sin[c+d*x])^(n+2),x] /;
FreeQ[{b,c,d,A,C},x] && NonzeroQ[C*(n+1)+A*(n+2)] && RationalQ[n] && n<-1


(* ::Code:: *)
Int[(A_+C_.*sin[c_.+d_.*x_]^2)*(b_.*sin[c_.+d_.*x_])^n_.,x_Symbol] :=
  -C*Cos[c+d*x]*(b*Sin[c+d*x])^(n+1)/(b*d*(n+2)) + 
  (C*(n+1)+A*(n+2))/(n+2)*Int[(b*Sin[c+d*x])^n,x] /;
FreeQ[{b,c,d,A,C,n},x] && NonzeroQ[C*(n+1)+A*(n+2)] && Not[RationalQ[n] && n<-1]


(* ::Code:: *)
Int[(A_+B_.*sin[c_.+d_.*x_]+C_.*sin[c_.+d_.*x_]^2)/sin[c_.+d_.*x_],x_Symbol] :=
  B*x + Int[(A+C*Sin[c+d*x]^2)/Sin[c+d*x],x] /;
FreeQ[{c,d,A,B,C},x]


(* ::Code:: *)
Int[(A_+B_.*sin[c_.+d_.*x_]+C_.*sin[c_.+d_.*x_]^2)*(b_.*sin[c_.+d_.*x_])^n_.,x_Symbol] :=
  B/b*Int[(b*Sin[c+d*x])^(n+1),x] + 
  Int[(A+C*Sin[c+d*x]^2)*(b*Sin[c+d*x])^n,x] /;
FreeQ[{b,c,d,A,B,C,n},x] && NonzeroQ[n+1]


(* ::Code:: *)
Int[(A_+B_.*sin[c_.+d_.*x_]+C_.*sin[c_.+d_.*x_]^2)*(a_+b_.*sin[c_.+d_.*x_])^n_.,x_Symbol] :=
  -C*Cos[c+d*x]*(a+b*Sin[c+d*x])^(n+1)/(b*d*(n+2)) + 
  1/(b*(n+2))*Int[Simp[b*A*(n+2)+b*C*(n+1)+(b*B*(n+2)-a*C)*Sin[c+d*x],x]*(a+b*Sin[c+d*x])^n,x] /;
FreeQ[{a,b,c,d,A,B,C},x] && RationalQ[n] && n>=-1


(* ::Code:: *)
Int[(A_+C_.*sin[c_.+d_.*x_]^2)*(a_+b_.*sin[c_.+d_.*x_])^n_.,x_Symbol] :=
  -C*Cos[c+d*x]*(a+b*Sin[c+d*x])^(n+1)/(b*d*(n+2)) + 
  1/(b*(n+2))*Int[Simp[b*A*(n+2)+b*C*(n+1)-a*C*Sin[c+d*x],x]*(a+b*Sin[c+d*x])^n,x] /;
FreeQ[{a,b,c,d,A,C},x] && RationalQ[n] && n>=-1


(* ::Code:: *)
Int[(A_+B_.*sin[c_.+d_.*x_]+C_.*sin[c_.+d_.*x_]^2)*(a_+b_.*sin[c_.+d_.*x_])^n_,x_Symbol] :=
  1/b^2*Int[Simp[b*B-a*C+b*C*Sin[c+d*x],x]*(a+b*Sin[c+d*x])^(n+1),x] /;
FreeQ[{a,b,c,d,A,B,C},x] && RationalQ[n] && n<-1 && ZeroQ[A*b^2-a*b*B+a^2*C]


(* ::Code:: *)
Int[(A_+C_.*sin[c_.+d_.*x_]^2)*(a_+b_.*sin[c_.+d_.*x_])^n_,x_Symbol] :=
  C/b^2*Int[Simp[-a+b*Sin[c+d*x],x]*(a+b*Sin[c+d*x])^(n+1),x] /;
FreeQ[{a,b,c,d,A,C},x] && RationalQ[n] && n<-1 && ZeroQ[A*b^2+a^2*C]


(* ::Code:: *)
Int[(A_+B_.*sin[c_.+d_.*x_]+C_.*sin[c_.+d_.*x_]^2)*(a_+b_.*sin[c_.+d_.*x_])^n_,x_Symbol] :=
  (A*b-a*B+b*C)*Cos[c+d*x]*(a+b*Sin[c+d*x])^n/(a*d*(2*n+1)) + 
  1/(a^2*(2*n+1))*Int[Simp[a*A*(n+1)+n*(b*B-a*C)+b*C*(2*n+1)*Sin[c+d*x],x]*(a+b*Sin[c+d*x])^(n+1),x] /;
FreeQ[{a,b,c,d,A,B,C},x] && RationalQ[n] && n<-1 && NonzeroQ[A*b^2-a*b*B+a^2*C] && ZeroQ[a^2-b^2]


(* ::Code:: *)
Int[(A_+C_.*sin[c_.+d_.*x_]^2)*(a_+b_.*sin[c_.+d_.*x_])^n_,x_Symbol] :=
  b*(A+C)*Cos[c+d*x]*(a+b*Sin[c+d*x])^n/(a*d*(2*n+1)) + 
  1/(a^2*(2*n+1))*Int[Simp[a*A*(n+1)-a*C*n+b*C*(2*n+1)*Sin[c+d*x],x]*(a+b*Sin[c+d*x])^(n+1),x] /;
FreeQ[{a,b,c,d,A,C},x] && RationalQ[n] && n<-1 && NonzeroQ[A*b^2+a^2*C] && ZeroQ[a^2-b^2]


(* ::Code:: *)
Int[(A_+B_.*sin[c_.+d_.*x_]+C_.*sin[c_.+d_.*x_]^2)*(a_+b_.*sin[c_.+d_.*x_])^n_,x_Symbol] :=
  -(A*b^2-a*b*B+a^2*C)*Cos[c+d*x]*(a+b*Sin[c+d*x])^(n+1)/(b*d*(n+1)*(a^2-b^2)) + 
  1/(b*(n+1)*(a^2-b^2))*
    Int[Simp[b*(a*A-b*B+a*C)*(n+1)-(A*b^2-a*b*B+a^2*C+b*(A*b-a*B+b*C)*(n+1))*Sin[c+d*x],x]*(a+b*Sin[c+d*x])^(n+1),x] /;
FreeQ[{a,b,c,d,A,B,C},x] && RationalQ[n] && n<-1 && NonzeroQ[A*b^2-a*b*B+a^2*C] && NonzeroQ[a^2-b^2]


(* ::Code:: *)
Int[(A_+C_.*sin[c_.+d_.*x_]^2)*(a_+b_.*sin[c_.+d_.*x_])^n_,x_Symbol] :=
  -(A*b^2+a^2*C)*Cos[c+d*x]*(a+b*Sin[c+d*x])^(n+1)/(b*d*(n+1)*(a^2-b^2)) + 
  1/(b*(n+1)*(a^2-b^2))*
    Int[Simp[a*b*(A+C)*(n+1)-(A*b^2+a^2*C+b^2*(A+C)*(n+1))*Sin[c+d*x],x]*(a+b*Sin[c+d*x])^(n+1),x] /;
FreeQ[{a,b,c,d,A,C},x] && RationalQ[n] && n<-1 && NonzeroQ[A*b^2+a^2*C] && NonzeroQ[a^2-b^2]


(* ::Code:: *)
Int[(A_+B_.*sin[c_.+d_.*x_]+C_.*sin[c_.+d_.*x_]^2)*(a_.+b_.*sin[c_.+d_.*x_])^n_.,x_Symbol] :=
  Defer[Int][(A+B*Sin[c+d*x]+C*Sin[c+d*x]^2)*(a+b*Sin[c+d*x])^n,x] /;
FreeQ[{a,b,c,d,A,B,C,n},x]


(* ::Code:: *)
Int[(A_+C_.*sin[c_.+d_.*x_]^2)*(a_.+b_.*sin[c_.+d_.*x_])^n_.,x_Symbol] :=
  Defer[Int][(A+C*Sin[c+d*x]^2)*(a+b*Sin[c+d*x])^n,x] /;
FreeQ[{a,b,c,d,A,C,n},x]


(* ::Code:: *)
Int[sin[c_.+d_.*x_]^m_.*(A_+B_.*sin[c_.+d_.*x_]+C_.*sin[c_.+d_.*x_]^2)*(b_.*sin[c_.+d_.*x_])^n_,x_Symbol] :=
  1/b^m*Int[(A+B*Sin[c+d*x]+C*Sin[c+d*x]^2)*(b*Sin[c+d*x])^(m+n),x] /;
FreeQ[{b,c,d,A,B,C,n},x] && IntegerQ[m]


(* ::Code:: *)
Int[sin[c_.+d_.*x_]^m_.*(A_+C_.*sin[c_.+d_.*x_]^2)*(b_.*sin[c_.+d_.*x_])^n_,x_Symbol] :=
  1/b^m*Int[(A+C*Sin[c+d*x]^2)*(b*Sin[c+d*x])^(m+n),x] /;
FreeQ[{b,c,d,A,C,n},x] && IntegerQ[m]


(* ::Code:: *)
Int[sin[c_.+d_.*x_]^m_*(A_+B_.*sin[c_.+d_.*x_]+C_.*sin[c_.+d_.*x_]^2)*(b_*sin[c_.+d_.*x_])^n_,x_Symbol] :=
  b^(n-1/2)*Sqrt[b*Sin[c+d*x]]/Sqrt[Sin[c+d*x]]*Int[Sin[c+d*x]^(m+n)*(A+B*Sin[c+d*x]+C*Sin[c+d*x]^2),x] /;
FreeQ[{b,c,d,A,B,C},x] && Not[IntegerQ[m]] && PositiveIntegerQ[n+1/2]


(* ::Code:: *)
Int[sin[c_.+d_.*x_]^m_*(A_+C_.*sin[c_.+d_.*x_]^2)*(b_*sin[c_.+d_.*x_])^n_,x_Symbol] :=
  b^(n-1/2)*Sqrt[b*Sin[c+d*x]]/Sqrt[Sin[c+d*x]]*Int[Sin[c+d*x]^(m+n)*(A+C*Sin[c+d*x]^2),x] /;
FreeQ[{b,c,d,A,C},x] && Not[IntegerQ[m]] && PositiveIntegerQ[n+1/2]


(* ::Code:: *)
Int[sin[c_.+d_.*x_]^m_*(A_+B_.*sin[c_.+d_.*x_]+C_.*sin[c_.+d_.*x_]^2)*(b_*sin[c_.+d_.*x_])^n_,x_Symbol] :=
  b^(n+1/2)*Sqrt[Sin[c+d*x]]/Sqrt[b*Sin[c+d*x]]*Int[Sin[c+d*x]^(m+n)*(A+B*Sin[c+d*x]+C*Sin[c+d*x]^2),x] /;
FreeQ[{b,c,d,A,B,C},x] && Not[IntegerQ[m]] && NegativeIntegerQ[n-1/2]


(* ::Code:: *)
Int[sin[c_.+d_.*x_]^m_*(A_+C_.*sin[c_.+d_.*x_]^2)*(b_*sin[c_.+d_.*x_])^n_,x_Symbol] :=
  b^(n+1/2)*Sqrt[Sin[c+d*x]]/Sqrt[b*Sin[c+d*x]]*Int[Sin[c+d*x]^(m+n)*(A+C*Sin[c+d*x]^2),x] /;
FreeQ[{b,c,d,A,C},x] && Not[IntegerQ[m]] && NegativeIntegerQ[n-1/2]


(* ::Code:: *)
Int[sin[c_.+d_.*x_]^m_.*(A_+B_.*sin[c_.+d_.*x_]+C_.*sin[c_.+d_.*x_]^2)*(b_.*sin[c_.+d_.*x_])^n_,x_Symbol] :=
  (b*Sin[c+d*x])^n/Sin[c+d*x]^n*Int[Sin[c+d*x]^(m+n)*(A+B*Sin[c+d*x]+C*Sin[c+d*x]^2),x] /;
FreeQ[{b,c,d,A,B,C,m,n},x] && Not[IntegerQ[m]] && Not[IntegerQ[n-1/2]]


(* ::Code:: *)
Int[sin[c_.+d_.*x_]^m_.*(A_+C_.*sin[c_.+d_.*x_]^2)*(b_.*sin[c_.+d_.*x_])^n_,x_Symbol] :=
  (b*Sin[c+d*x])^n/Sin[c+d*x]^n*Int[Sin[c+d*x]^(m+n)*(A+C*Sin[c+d*x]^2),x] /;
FreeQ[{b,c,d,A,C,m,n},x]


(* ::Code:: *)
Int[sin[c_.+d_.*x_]^m_.*(A_+B_.*sin[c_.+d_.*x_]+C_.*sin[c_.+d_.*x_]^2)*(a_+b_.*sin[c_.+d_.*x_])^n_,x_Symbol] :=
  1/b^2*Int[Sin[c+d*x]^m*Simp[b*B-a*C+b*C*Sin[c+d*x],x]*(a+b*Sin[c+d*x])^(n+1),x] /;
FreeQ[{a,b,c,d,A,B,C,m},x] && ZeroQ[A*b^2-a*b*B+a^2*C] && RationalQ[n] && n<=-1


(* ::Code:: *)
Int[sin[c_.+d_.*x_]^m_.*(A_+C_.*sin[c_.+d_.*x_]^2)*(a_+b_.*sin[c_.+d_.*x_])^n_,x_Symbol] :=
  C/b^2*Int[Sin[c+d*x]^m*Simp[-a+b*Sin[c+d*x],x]*(a+b*Sin[c+d*x])^(n+1),x] /;
FreeQ[{a,b,c,d,A,C,m},x] && ZeroQ[A*b^2+a^2*C] && RationalQ[n] && n<=-1


(* ::Code:: *)
Int[sin[c_.+d_.*x_]^m_.*(A_+B_.*sin[c_.+d_.*x_]+C_.*sin[c_.+d_.*x_]^2)*(a_+b_.*sin[c_.+d_.*x_]),x_Symbol] :=
  -b*C*Cos[c+d*x]*Sin[c+d*x]^(m+2)/(d*(m+3)) + 
  1/(m+3)*Int[Sin[c+d*x]^m*Simp[(m+3)*a*A+((m+3)*(b*A+a*B)+(m+2)*b*C)*Sin[c+d*x]+(m+3)*(b*B+a*C)*Sin[c+d*x]^2,x],x] /;
FreeQ[{a,b,c,d,A,B,C},x] && RationalQ[m] && m>=-1


(* ::Code:: *)
Int[sin[c_.+d_.*x_]^m_.*(A_+C_.*sin[c_.+d_.*x_]^2)*(a_+b_.*sin[c_.+d_.*x_]),x_Symbol] :=
  -b*C*Cos[c+d*x]*Sin[c+d*x]^(m+2)/(d*(m+3)) + 
  1/(m+3)*Int[Sin[c+d*x]^m*Simp[(m+3)*a*A+((m+3)*b*A+(m+2)*b*C)*Sin[c+d*x]+(m+3)*a*C*Sin[c+d*x]^2,x],x] /;
FreeQ[{a,b,c,d,A,C},x] && RationalQ[m] && m>=-1


(* ::Code:: *)
Int[sin[c_.+d_.*x_]^m_.*(A_+B_.*sin[c_.+d_.*x_]+C_.*sin[c_.+d_.*x_]^2)*(a_+b_.*sin[c_.+d_.*x_]),x_Symbol] :=
  a*A*Cos[c+d*x]*Sin[c+d*x]^(m+1)/(d*(m+1)) + 
  1/(m+1)*Int[Sin[c+d*x]^(m+1)*Simp[(m+1)*(b*A+a*B)+((m+2)*a*A+(m+1)*(b*B+a*C))*Sin[c+d*x]+(m+1)*b*C*Sin[c+d*x]^2,x],x] /;
FreeQ[{a,b,c,d,A,B,C},x] && RationalQ[m] && m<-1


(* ::Code:: *)
Int[sin[c_.+d_.*x_]^m_.*(A_+C_.*sin[c_.+d_.*x_]^2)*(a_+b_.*sin[c_.+d_.*x_]),x_Symbol] :=
  a*A*Cos[c+d*x]*Sin[c+d*x]^(m+1)/(d*(m+1)) + 
  1/(m+1)*Int[Sin[c+d*x]^(m+1)*Simp[(m+1)*b*A+((m+2)*a*A+(m+1)*a*C)*Sin[c+d*x]+(m+1)*b*C*Sin[c+d*x]^2,x],x] /;
FreeQ[{a,b,c,d,A,C},x] && RationalQ[m] && m<-1


(* ::Code:: *)
Int[sin[c_.+d_.*x_]^m_.*(A_+B_.*sin[c_.+d_.*x_]+C_.*sin[c_.+d_.*x_]^2)*(a_+b_.*sin[c_.+d_.*x_])^n_,x_Symbol] :=
  -C*Cos[c+d*x]*Sin[c+d*x]^(m+1)*(a+b*Sin[c+d*x])^n/(d*(m+n+2)) + 
  1/(a*(m+n+2))*Int[Sin[c+d*x]^m*Simp[a*C*(m+1)+a*A*(m+n+2)+(b*C*n+a*B*(m+n+2))*Sin[c+d*x],x]*(a+b*Sin[c+d*x])^n,x] /;
FreeQ[{a,b,c,d,A,B,C},x] && ZeroQ[a^2-b^2] && RationalQ[m,n] && n>-1 && m>=-1


(* ::Code:: *)
Int[sin[c_.+d_.*x_]^m_.*(A_+C_.*sin[c_.+d_.*x_]^2)*(a_+b_.*sin[c_.+d_.*x_])^n_,x_Symbol] :=
  -C*Cos[c+d*x]*Sin[c+d*x]^(m+1)*(a+b*Sin[c+d*x])^n/(d*(m+n+2)) + 
  1/(a*(m+n+2))*Int[Sin[c+d*x]^m*Simp[a*C*(m+1)+a*A*(m+n+2)+b*C*n*Sin[c+d*x],x]*(a+b*Sin[c+d*x])^n,x] /;
FreeQ[{a,b,c,d,A,C},x] && ZeroQ[a^2-b^2] && RationalQ[m,n] && n>-1 && m>=-1


(* ::Code:: *)
Int[sin[c_.+d_.*x_]^m_*(A_+B_.*sin[c_.+d_.*x_]+C_.*sin[c_.+d_.*x_]^2)*(a_+b_.*sin[c_.+d_.*x_])^n_,x_Symbol] :=
  A*Cos[c+d*x]*Sin[c+d*x]^(m+1)*(a+b*Sin[c+d*x])^n/(d*(m+1)) + 
  1/(a*(m+1))*Int[Sin[c+d*x]^(m+1)*Simp[a*B*(m+1)-b*A*n+a*(C*(m+1)+A*(m+n+2))*Sin[c+d*x],x]*(a+b*Sin[c+d*x])^n,x] /;
FreeQ[{a,b,c,d,A,B,C},x] && ZeroQ[a^2-b^2] && RationalQ[m,n] && n>-1 && m<-1


(* ::Code:: *)
Int[sin[c_.+d_.*x_]^m_*(A_+C_.*sin[c_.+d_.*x_]^2)*(a_+b_.*sin[c_.+d_.*x_])^n_,x_Symbol] :=
  A*Cos[c+d*x]*Sin[c+d*x]^(m+1)*(a+b*Sin[c+d*x])^n/(d*(m+1)) + 
  1/(a*(m+1))*Int[Sin[c+d*x]^(m+1)*Simp[-b*A*n+a*(C*(m+1)+A*(m+n+2))*Sin[c+d*x],x]*(a+b*Sin[c+d*x])^n,x] /;
FreeQ[{a,b,c,d,A,C},x] && ZeroQ[a^2-b^2] && RationalQ[m,n] && n>-1 && m<-1


(* ::Code:: *)
Int[sin[c_.+d_.*x_]^m_.*(A_+B_.*sin[c_.+d_.*x_]+C_.*sin[c_.+d_.*x_]^2)*(a_+b_.*sin[c_.+d_.*x_])^n_,x_Symbol] :=
  1/(a*b)*Int[Sin[c+d*x]^m*Simp[b*A+a*C*Sin[c+d*x],x]*(a+b*Sin[c+d*x])^(n+1),x] /;
FreeQ[{a,b,c,d,A,B,C,m},x] && RationalQ[n] && n<-1 && ZeroQ[A*b-a*B+b*C]


(* ::Code:: *)
Int[sin[c_.+d_.*x_]^m_.*(A_+C_.*sin[c_.+d_.*x_]^2)*(a_+b_.*sin[c_.+d_.*x_])^n_,x_Symbol] :=
  1/(a*b)*Int[Sin[c+d*x]^m*Simp[b*A+a*C*Sin[c+d*x],x]*(a+b*Sin[c+d*x])^(n+1),x] /;
FreeQ[{a,b,c,d,A,C,m},x] && RationalQ[n] && n<-1 && ZeroQ[A*b+b*C]


(* ::Code:: *)
Int[sin[c_.+d_.*x_]^m_.*(A_+B_.*sin[c_.+d_.*x_]+C_.*sin[c_.+d_.*x_]^2)*(a_+b_.*sin[c_.+d_.*x_])^n_,x_Symbol] :=
  -(A*b-a*B+b*C)*Cos[c+d*x]*Sin[c+d*x]^(m+1)*(a+b*Sin[c+d*x])^n/(b*d*(2*n+1)) + 
  1/(a^2*(2*n+1))*
    Int[Sin[c+d*x]^m*Simp[a*A*(2*n+1)-(b*B-a*A-a*C)*(m+1)+(b*C*n-(b*A-a*B)*(n+1)-(A*b-a*B+b*C)*(m+1))*Sin[c+d*x],x]*(a+b*Sin[c+d*x])^(n+1),x] /;
FreeQ[{a,b,c,d,A,B,C},x] && ZeroQ[a^2-b^2] && RationalQ[m,n] && n<=-1 && NonzeroQ[A*b-a*B+b*C]


(* ::Code:: *)
Int[sin[c_.+d_.*x_]^m_.*(A_+C_.*sin[c_.+d_.*x_]^2)*(a_+b_.*sin[c_.+d_.*x_])^n_,x_Symbol] :=
  -(A+C)*Cos[c+d*x]*Sin[c+d*x]^(m+1)*(a+b*Sin[c+d*x])^n/(d*(2*n+1)) + 
  1/(a^2*(2*n+1))*
    Int[Sin[c+d*x]^m*Simp[a*A*(2*n+1)+a*(A+C)*(m+1)+(b*C*n-b*A*(n+1)-b*(A+C)*(m+1))*Sin[c+d*x],x]*(a+b*Sin[c+d*x])^(n+1),x] /;
FreeQ[{a,b,c,d,A,C},x] && ZeroQ[a^2-b^2] && RationalQ[m,n] && n<=-1 && NonzeroQ[A+C]


(* ::Code:: *)
Int[sin[c_.+d_.*x_]^m_.*(A_+B_.*sin[c_.+d_.*x_]+C_.*sin[c_.+d_.*x_]^2)*(a_+b_.*sin[c_.+d_.*x_])^n_,x_Symbol] :=
  -C*Cos[c+d*x]*Sin[c+d*x]^(m+1)*(a+b*Sin[c+d*x])^n/(d*(m+n+2)) + 
  1/(m+n+2)*
    Int[Sin[c+d*x]^m*
      Simp[a*(A*(n+1)+(A+C)*(m+1))+(b*A+a*B+(b*A+a*B+b*C)*(m+n+1))*Sin[c+d*x]+
        (a*C*n+b*B*(m+n+2))*Sin[c+d*x]^2,x]*
      (a+b*Sin[c+d*x])^(n-1),x] /;
FreeQ[{a,b,c,d,A,B,C},x] && NonzeroQ[a^2-b^2] && RationalQ[m,n] && n>0 && m>=-1


(* ::Code:: *)
Int[sin[c_.+d_.*x_]^m_.*(A_+C_.*sin[c_.+d_.*x_]^2)*(a_+b_.*sin[c_.+d_.*x_])^n_,x_Symbol] :=
  -C*Cos[c+d*x]*Sin[c+d*x]^(m+1)*(a+b*Sin[c+d*x])^n/(d*(m+n+2)) + 
  1/(m+n+2)*
    Int[Sin[c+d*x]^m*
      Simp[a*(A*(n+1)+(A+C)*(m+1))+(b*A+(b*A+b*C)*(m+n+1))*Sin[c+d*x]+a*C*n*Sin[c+d*x]^2,x]*
      (a+b*Sin[c+d*x])^(n-1),x] /;
FreeQ[{a,b,c,d,A,C},x] && NonzeroQ[a^2-b^2] && RationalQ[m,n] && n>0 && m>=-1


(* ::Code:: *)
Int[sin[c_.+d_.*x_]^m_.*(A_+B_.*sin[c_.+d_.*x_]+C_.*sin[c_.+d_.*x_]^2)*(a_+b_.*sin[c_.+d_.*x_])^n_,x_Symbol] :=
  A*Cos[c+d*x]*Sin[c+d*x]^(m+1)*(a+b*Sin[c+d*x])^n/(d*(m+1)) + 
  1/(m+1)*
    Int[Sin[c+d*x]^(m+1)*
      Simp[a*B*(m+1)-b*A*n+(a*A+(a*A+a*C+b*B)*(m+1))*Sin[c+d*x]+
        b*(A*(n+1)+(A+C)*(m+1))*Sin[c+d*x]^2,x]*
      (a+b*Sin[c+d*x])^(n-1),x] /;
FreeQ[{a,b,c,d,A,B,C},x] && NonzeroQ[a^2-b^2] && RationalQ[m,n] && n>0 && m<-1


(* ::Code:: *)
Int[sin[c_.+d_.*x_]^m_.*(A_+C_.*sin[c_.+d_.*x_]^2)*(a_+b_.*sin[c_.+d_.*x_])^n_,x_Symbol] :=
  A*Cos[c+d*x]*Sin[c+d*x]^(m+1)*(a+b*Sin[c+d*x])^n/(d*(m+1)) + 
  1/(m+1)*
    Int[Sin[c+d*x]^(m+1)*
      Simp[-b*A*n+a*(A+(A+C)*(m+1))*Sin[c+d*x]+b*(A*(n+1)+(A+C)*(m+1))*Sin[c+d*x]^2,x]*
      (a+b*Sin[c+d*x])^(n-1),x] /;
FreeQ[{a,b,c,d,A,C},x] && NonzeroQ[a^2-b^2] && RationalQ[m,n] && n>0 && m<-1


(* ::Code:: *)
Int[sin[c_.+d_.*x_]^m_.*(A_+B_.*sin[c_.+d_.*x_]+C_.*sin[c_.+d_.*x_]^2)/(a_+b_.*sin[c_.+d_.*x_]),x_Symbol] :=
  -C*Cos[c+d*x]*Sin[c+d*x]^m/(b*d*(m+1)) + 
  1/(b*(m+1))*Int[Sin[c+d*x]^(m-1)*Simp[a*C*m+b*(A+m*(A+C))*Sin[c+d*x]+(b*B-a*C)*(m+1)*Sin[c+d*x]^2,x]/(a+b*Sin[c+d*x]),x] /;
FreeQ[{a,b,c,d,A,B,C},x] && NonzeroQ[a^2-b^2] && RationalQ[m] && m>0


(* ::Code:: *)
Int[sin[c_.+d_.*x_]^m_.*(A_+C_.*sin[c_.+d_.*x_]^2)/(a_+b_.*sin[c_.+d_.*x_]),x_Symbol] :=
  -C*Cos[c+d*x]*Sin[c+d*x]^m/(b*d*(m+1)) + 
  1/(b*(m+1))*Int[Sin[c+d*x]^(m-1)*Simp[a*C*m+b*(A+m*(A+C))*Sin[c+d*x]-a*C*(m+1)*Sin[c+d*x]^2,x]/(a+b*Sin[c+d*x]),x] /;
FreeQ[{a,b,c,d,A,C},x] && NonzeroQ[a^2-b^2] && RationalQ[m] && m>0


(* ::Code:: *)
Int[(A_+B_.*sin[c_.+d_.*x_]+C_.*sin[c_.+d_.*x_]^2)/(sin[c_.+d_.*x_]*(a_+b_.*sin[c_.+d_.*x_])),x_Symbol] :=
  A/a*Int[1/Sin[c+d*x],x] - 
  1/a*Int[Simp[b*A-a*B-a*C*Sin[c+d*x],x]/(a+b*Sin[c+d*x]),x] /;
FreeQ[{a,b,c,d,A,B,C},x] && NonzeroQ[a^2-b^2]


(* ::Code:: *)
Int[(A_+C_.*sin[c_.+d_.*x_]^2)/(sin[c_.+d_.*x_]*(a_+b_.*sin[c_.+d_.*x_])),x_Symbol] :=
  A/a*Int[1/Sin[c+d*x],x] - 
  1/a*Int[Simp[b*A-a*C*Sin[c+d*x],x]/(a+b*Sin[c+d*x]),x] /;
FreeQ[{a,b,c,d,A,C},x] && NonzeroQ[a^2-b^2]


(* ::Code:: *)
Int[(A_+B_.*sin[c_.+d_.*x_]+C_.*sin[c_.+d_.*x_]^2)/(Sqrt[sin[c_.+d_.*x_]]*(a_+b_.*sin[c_.+d_.*x_])),x_Symbol] :=
  C/b*Int[Sqrt[Sin[c+d*x]],x] + 
  1/b*Int[Simp[b*A+(b*B-a*C)*Sin[c+d*x],x]/(Sqrt[Sin[c+d*x]]*(a+b*Sin[c+d*x])),x] /;
FreeQ[{a,b,c,d,A,B,C},x] && NonzeroQ[a^2-b^2]


(* ::Code:: *)
Int[(A_+C_.*sin[c_.+d_.*x_]^2)/(Sqrt[sin[c_.+d_.*x_]]*(a_+b_.*sin[c_.+d_.*x_])),x_Symbol] :=
  C/b*Int[Sqrt[Sin[c+d*x]],x] + 
  1/b*Int[Simp[b*A-a*C*Sin[c+d*x],x]/(Sqrt[Sin[c+d*x]]*(a+b*Sin[c+d*x])),x] /;
FreeQ[{a,b,c,d,A,C},x] && NonzeroQ[a^2-b^2]


(* ::Code:: *)
Int[sin[c_.+d_.*x_]^m_.*(A_+B_.*sin[c_.+d_.*x_]+C_.*sin[c_.+d_.*x_]^2)/(a_+b_.*sin[c_.+d_.*x_]),x_Symbol] :=
  A*Cos[c+d*x]*Sin[c+d*x]^(m+1)/(a*d*(m+1)) + 
  1/(a*(m+1))*
    Int[Sin[c+d*x]^(m+1)*Simp[(a*B-b*A)*(m+1)+a*(A+(A+C)*(m+1))*Sin[c+d*x]+b*A*(m+2)*Sin[c+d*x]^2,x]/(a+b*Sin[c+d*x]),x] /;
FreeQ[{a,b,c,d,A,B,C},x] && NonzeroQ[a^2-b^2] && RationalQ[m] && m<-1


(* ::Code:: *)
Int[sin[c_.+d_.*x_]^m_.*(A_+C_.*sin[c_.+d_.*x_]^2)/(a_+b_.*sin[c_.+d_.*x_]),x_Symbol] :=
  A*Cos[c+d*x]*Sin[c+d*x]^(m+1)/(a*d*(m+1)) + 
  1/(a*(m+1))*
    Int[Sin[c+d*x]^(m+1)*Simp[-b*A*(m+1)+a*(A+(A+C)*(m+1))*Sin[c+d*x]+b*A*(m+2)*Sin[c+d*x]^2,x]/(a+b*Sin[c+d*x]),x] /;
FreeQ[{a,b,c,d,A,C},x] && NonzeroQ[a^2-b^2] && RationalQ[m] && m<-1


(* ::Code:: *)
Int[sin[c_.+d_.*x_]^m_.*(A_+B_.*sin[c_.+d_.*x_]+C_.*sin[c_.+d_.*x_]^2)/Sqrt[a_+b_.*sin[c_.+d_.*x_]],x_Symbol] :=
  -2*C*Cos[c+d*x]*Sin[c+d*x]^m*Sqrt[a+b*Sin[c+d*x]]/(b*d*(2*m+3)) + 
  1/(b*(2*m+3))*
    Int[Sin[c+d*x]^(m-1)*
      Simp[2*a*C*m+b*(2*A+(A+C)*(2*m+1))*Sin[c+d*x]+(b*B+2*(b*B-a*C)*(m+1))*Sin[c+d*x]^2,x]/
      Sqrt[a+b*Sin[c+d*x]],x] /;
FreeQ[{a,b,c,d,A,B,C},x] && NonzeroQ[a^2-b^2] && RationalQ[m] && m>0


(* ::Code:: *)
Int[sin[c_.+d_.*x_]^m_.*(A_+C_.*sin[c_.+d_.*x_]^2)/Sqrt[a_+b_.*sin[c_.+d_.*x_]],x_Symbol] :=
  -2*C*Cos[c+d*x]*Sin[c+d*x]^m*Sqrt[a+b*Sin[c+d*x]]/(b*d*(2*m+3)) + 
  1/(b*(2*m+3))*
    Int[Sin[c+d*x]^(m-1)*
      Simp[2*a*C*m+b*(2*A+(A+C)*(2*m+1))*Sin[c+d*x]-2*a*C*(m+1)*Sin[c+d*x]^2,x]/
      Sqrt[a+b*Sin[c+d*x]],x] /;
FreeQ[{a,b,c,d,A,C},x] && NonzeroQ[a^2-b^2] && RationalQ[m] && m>0


(* ::Code:: *)
Int[(A_+B_.*sin[c_.+d_.*x_]+C_.*sin[c_.+d_.*x_]^2)/(sin[c_.+d_.*x_]*Sqrt[a_+b_.*sin[c_.+d_.*x_]]),x_Symbol] :=
  C/b*Int[Sqrt[a+b*Sin[c+d*x]],x] +
  1/b*Int[Simp[b*A+(b*B-a*C)*Sin[c+d*x],x]/(Sin[c+d*x]*Sqrt[a+b*Sin[c+d*x]]),x] /;
FreeQ[{a,b,c,d,A,B,C},x] && NonzeroQ[a^2-b^2]


(* ::Code:: *)
Int[(A_+C_.*sin[c_.+d_.*x_]^2)/(sin[c_.+d_.*x_]*Sqrt[a_+b_.*sin[c_.+d_.*x_]]),x_Symbol] :=
  C/b*Int[Sqrt[a+b*Sin[c+d*x]],x] + 
  1/b*Int[Simp[A*b-a*C*Sin[c+d*x],x]/(Sin[c+d*x]*Sqrt[a+b*Sin[c+d*x]]),x] /;
FreeQ[{a,b,c,d,A,C},x] && NonzeroQ[a^2-b^2]


(* ::Code:: *)
Int[(A_+C_.*sin[c_.+d_.*x_]^2)/(Sqrt[sin[c_.+d_.*x_]]*Sqrt[a_+b_.*sin[c_.+d_.*x_]]),x_Symbol] :=
  A*Int[1/(Sqrt[Sin[c+d*x]]*Sqrt[a+b*Sin[c+d*x]]),x] + 
  C*Int[Sin[c+d*x]^(3/2)/Sqrt[a+b*Sin[c+d*x]],x] /;
FreeQ[{a,b,c,d,A,C},x] && NonzeroQ[a^2-b^2]


(* ::Code:: *)
Int[(A_+B_.*sin[c_.+d_.*x_]+C_.*sin[c_.+d_.*x_]^2)/(Sqrt[sin[c_.+d_.*x_]]*Sqrt[a_+b_.*sin[c_.+d_.*x_]]),x_Symbol] :=
  -C*Cos[c+d*x]*Sqrt[Sin[c+d*x]]*Sqrt[a+b*Sin[c+d*x]]/(b*d*(1+Sin[c+d*x])) + 
  C/b*Int[Sqrt[a+b*Sin[c+d*x]]/(Sqrt[Sin[c+d*x]]*(1+Sin[c+d*x])),x] /;
FreeQ[{a,b,c,d,A,B,C},x] && NonzeroQ[a^2-b^2] && ZeroQ[A-B] && ZeroQ[2*A*b-a*C]


(* ::Code:: *)
Int[(A_+B_.*sin[c_.+d_.*x_]+C_.*sin[c_.+d_.*x_]^2)/(Sqrt[sin[c_.+d_.*x_]]*Sqrt[a_+b_.*sin[c_.+d_.*x_]]),x_Symbol] :=
  1/(2*b)*Int[(2*A*b-a*C+(2*b*B-a*C)*Sin[c+d*x])/(Sqrt[Sin[c+d*x]]*Sqrt[a+b*Sin[c+d*x]]),x] + 
  C/(2*b)*Int[Simp[a+a*Sin[c+d*x]+2*b*Sin[c+d*x]^2,x]/(Sqrt[Sin[c+d*x]]*Sqrt[a+b*Sin[c+d*x]]),x] /;
FreeQ[{a,b,c,d,A,B,C},x] && NonzeroQ[a^2-b^2] && Not[ZeroQ[A-B] && ZeroQ[2*A*b-a*C]]


(* ::Code:: *)
Int[(A_+B_.*sin[c_.+d_.*x_]+C_.*sin[c_.+d_.*x_]^2)/(sin[c_.+d_.*x_]^(3/2)*Sqrt[a_+b_.*sin[c_.+d_.*x_]]),x_Symbol] :=
  C*Int[(1+Sin[c+d*x])/(Sqrt[Sin[c+d*x]]*Sqrt[a+b*Sin[c+d*x]]),x] + 
  Int[Simp[A+(B-C)*Sin[c+d*x],x]/(Sin[c+d*x]^(3/2)*Sqrt[a+b*Sin[c+d*x]]),x] /;
FreeQ[{a,b,c,d,A,B,C},x] && NonzeroQ[a^2-b^2]


(* ::Code:: *)
Int[(A_+C_.*sin[c_.+d_.*x_]^2)/(sin[c_.+d_.*x_]^(3/2)*Sqrt[a_+b_.*sin[c_.+d_.*x_]]),x_Symbol] :=
  C*Int[(1+Sin[c+d*x])/(Sqrt[Sin[c+d*x]]*Sqrt[a+b*Sin[c+d*x]]),x] + 
  Int[Simp[A-C*Sin[c+d*x],x]/(Sin[c+d*x]^(3/2)*Sqrt[a+b*Sin[c+d*x]]),x] /;
FreeQ[{a,b,c,d,A,C},x] && NonzeroQ[a^2-b^2]


(* ::Code:: *)
Int[sin[c_.+d_.*x_]^m_.*(A_+B_.*sin[c_.+d_.*x_]+C_.*sin[c_.+d_.*x_]^2)/Sqrt[a_+b_.*sin[c_.+d_.*x_]],x_Symbol] :=
  A*Cos[c+d*x]*Sin[c+d*x]^(m+1)*Sqrt[a+b*Sin[c+d*x]]/(a*d*(m+1)) + 
  1/(2*a*(m+1))*
    Int[Sin[c+d*x]^(m+1)*
      Simp[2*(a*B-b*A)*(m+1)-b*A+2*a*(A+(A+C)*(m+1))*Sin[c+d*x]+b*A*(2*m+5)*Sin[c+d*x]^2,x]/
      Sqrt[a+b*Sin[c+d*x]],x] /;
FreeQ[{a,b,c,d,A,B,C},x] && NonzeroQ[a^2-b^2] && RationalQ[m] && m<=-2


(* ::Code:: *)
Int[sin[c_.+d_.*x_]^m_.*(A_+C_.*sin[c_.+d_.*x_]^2)/Sqrt[a_+b_.*sin[c_.+d_.*x_]],x_Symbol] :=
  A*Cos[c+d*x]*Sin[c+d*x]^(m+1)*Sqrt[a+b*Sin[c+d*x]]/(a*d*(m+1)) + 
  1/(2*a*(m+1))*
    Int[Sin[c+d*x]^(m+1)*
      Simp[-2*b*A*(m+1)-b*A+2*a*(A+(A+C)*(m+1))*Sin[c+d*x]+b*A*(2*m+5)*Sin[c+d*x]^2,x]/
      Sqrt[a+b*Sin[c+d*x]],x] /;
FreeQ[{a,b,c,d,A,C},x] && NonzeroQ[a^2-b^2] && RationalQ[m] && m<=-2


(* ::Code:: *)
Int[sin[c_.+d_.*x_]^m_.*(A_+B_.*sin[c_.+d_.*x_]+C_.*sin[c_.+d_.*x_]^2)*(a_+b_.*sin[c_.+d_.*x_])^n_,x_Symbol] :=
  -(A*b^2-a*b*B+a^2*C)*Cos[c+d*x]*Sin[c+d*x]^m*(a+b*Sin[c+d*x])^(n+1)/(b*d*(n+1)*(a^2-b^2)) + 
  1/(b*(n+1)*(a^2-b^2))*
    Int[Sin[c+d*x]^(m-1)*
      Simp[m*(A*b^2-a*b*B+a^2*C)+b*(a*A-b*B+a*C)*(n+1)*Sin[c+d*x]-((A*b^2-a*b*B+b^2*C)*(n+1)+(A*b^2-a*b*B+a^2*C)*(m+1))*Sin[c+d*x]^2,x]*
      (a+b*Sin[c+d*x])^(n+1),x] /;
FreeQ[{a,b,c,d,A,B,C},x] && NonzeroQ[a^2-b^2] && RationalQ[m,n] && n<-1 && m>0


(* ::Code:: *)
Int[sin[c_.+d_.*x_]^m_.*(A_+C_.*sin[c_.+d_.*x_]^2)*(a_+b_.*sin[c_.+d_.*x_])^n_,x_Symbol] :=
  -(A*b^2+a^2*C)*Cos[c+d*x]*Sin[c+d*x]^m*(a+b*Sin[c+d*x])^(n+1)/(b*d*(n+1)*(a^2-b^2)) + 
  1/(b*(n+1)*(a^2-b^2))*
    Int[Sin[c+d*x]^(m-1)*
      Simp[m*(A*b^2+a^2*C)+b*(a*A+a*C)*(n+1)*Sin[c+d*x]-((A*b^2+b^2*C)*(n+1)+(A*b^2+a^2*C)*(m+1))*Sin[c+d*x]^2,x]*
      (a+b*Sin[c+d*x])^(n+1),x] /;
FreeQ[{a,b,c,d,A,C},x] && NonzeroQ[a^2-b^2] && RationalQ[m,n] && n<-1 && m>0


(* ::Code:: *)
Int[(A_+B_.*sin[c_.+d_.*x_]+C_.*sin[c_.+d_.*x_]^2)/(Sqrt[sin[c_.+d_.*x_]]*(a_+b_.*sin[c_.+d_.*x_])^(3/2)),x_Symbol] :=
  C/b*Int[(1+Sin[c+d*x])/(Sqrt[Sin[c+d*x]]*Sqrt[a+b*Sin[c+d*x]]),x] + 
  1/b*Int[Simp[b*A-a*C+(b*B-C*(a+b))*Sin[c+d*x],x]/(Sqrt[Sin[c+d*x]]*(a+b*Sin[c+d*x])^(3/2)),x] /;
FreeQ[{a,b,c,d,A,B,C},x] && NonzeroQ[a^2-b^2]


(* ::Code:: *)
Int[(A_+C_.*sin[c_.+d_.*x_]^2)/(Sqrt[sin[c_.+d_.*x_]]*(a_+b_.*sin[c_.+d_.*x_])^(3/2)),x_Symbol] :=
  C/b*Int[(1+Sin[c+d*x])/(Sqrt[Sin[c+d*x]]*Sqrt[a+b*Sin[c+d*x]]),x] + 
  1/b*Int[Simp[b*A-a*C-C*(a+b)*Sin[c+d*x],x]/(Sqrt[Sin[c+d*x]]*(a+b*Sin[c+d*x])^(3/2)),x] /;
FreeQ[{a,b,c,d,A,C},x] && NonzeroQ[a^2-b^2]


(* ::Code:: *)
Int[sin[c_.+d_.*x_]^m_.*(A_+B_.*sin[c_.+d_.*x_]+C_.*sin[c_.+d_.*x_]^2)*(a_+b_.*sin[c_.+d_.*x_])^n_,x_Symbol] :=
  (A*b^2-a*b*B+a^2*C)*Cos[c+d*x]*Sin[c+d*x]^(m+1)*(a+b*Sin[c+d*x])^(n+1)/(a*d*(n+1)*(a^2-b^2)) + 
  1/(a*(n+1)*(a^2-b^2))*
    Int[Sin[c+d*x]^m*
      Simp[A*(a^2-b^2)*(n+1)-(A*b^2-a*b*B+a^2*C)*(m+1)-a*(b*A-a*B+b*C)*(n+1)*Sin[c+d*x]+
        (A*b^2-a*b*B+a^2*C)*(m+n+3)*Sin[c+d*x]^2,x]*
      (a+b*Sin[c+d*x])^(n+1),x] /;
FreeQ[{a,b,c,d,A,B,C},x] && NonzeroQ[a^2-b^2] && RationalQ[m,n] && n<-1 && m<0


(* ::Code:: *)
Int[sin[c_.+d_.*x_]^m_.*(A_+C_.*sin[c_.+d_.*x_]^2)*(a_+b_.*sin[c_.+d_.*x_])^n_,x_Symbol] :=
  (A*b^2+a^2*C)*Cos[c+d*x]*Sin[c+d*x]^(m+1)*(a+b*Sin[c+d*x])^(n+1)/(a*d*(n+1)*(a^2-b^2)) + 
  1/(a*(n+1)*(a^2-b^2))*
    Int[Sin[c+d*x]^m*
      Simp[A*(a^2-b^2)*(n+1)-(A*b^2+a^2*C)*(m+1)-a*b*(A+C)*(n+1)*Sin[c+d*x]+(A*b^2+a^2*C)*(m+n+3)*Sin[c+d*x]^2,x]*
      (a+b*Sin[c+d*x])^(n+1),x] /;
FreeQ[{a,b,c,d,A,C},x] && NonzeroQ[a^2-b^2] && RationalQ[m,n] && n<-1 && m<0


(* ::Code:: *)
Int[sin[c_.+d_.*x_]^m_.*(A_+B_.*sin[c_.+d_.*x_]+C_.*sin[c_.+d_.*x_]^2)*(a_.+b_.*sin[c_.+d_.*x_])^n_.,x_Symbol] :=
  Defer[Int][Sin[c+d*x]^m*(A+B*Sin[c+d*x]+C*Sin[c+d*x]^2)*(a+b*Sin[c+d*x])^n,x] /;
FreeQ[{a,b,c,d,A,B,C,m,n},x]


(* ::Code:: *)
Int[sin[c_.+d_.*x_]^m_.*(A_+C_.*sin[c_.+d_.*x_]^2)*(a_.+b_.*sin[c_.+d_.*x_])^n_.,x_Symbol] :=
  Defer[Int][Sin[c+d*x]^m*(A+C*Sin[c+d*x]^2)*(a+b*Sin[c+d*x])^n,x] /;
FreeQ[{a,b,c,d,A,C,m,n},x]


(* ::Code:: *)
Int[csc[c_.+d_.*x_]^m_*(A_.+B_.*sin[c_.+d_.*x_]+C_.*sin[c_.+d_.*x_]^2),x_Symbol] :=
  Csc[c+d*x]^m*Sin[c+d*x]^m*Int[(A+B*Sin[c+d*x]+C*Sin[c+d*x]^2)/Sin[c+d*x]^m,x] /;
FreeQ[{c,d,A,B,C,m},x] && Not[IntegerQ[m]]


(* ::Code:: *)
Int[csc[c_.+d_.*x_]^m_*(A_.+C_.*sin[c_.+d_.*x_]^2),x_Symbol] :=
  Csc[c+d*x]^m*Sin[c+d*x]^m*Int[(A+C*Sin[c+d*x]^2)/Sin[c+d*x]^m,x] /;
FreeQ[{c,d,A,C,m},x] && Not[IntegerQ[m]]


(* ::Code:: *)
Int[csc[c_.+d_.*x_]^m_*(A_.+B_.*sin[c_.+d_.*x_]+C_.*sin[c_.+d_.*x_]^2)*(a_.+b_.*sin[c_.+d_.*x_])^n_.,x_Symbol] :=
  Csc[c+d*x]^m*Sin[c+d*x]^m*Int[(A+B*Sin[c+d*x]+C*Sin[c+d*x]^2)*(a+b*Sin[c+d*x])^n/Sin[c+d*x]^m,x] /;
FreeQ[{a,b,c,d,A,B,C,m,n},x] && Not[IntegerQ[m]]


(* ::Code:: *)
Int[csc[c_.+d_.*x_]^m_*(A_.+C_.*sin[c_.+d_.*x_]^2)*(a_.+b_.*sin[c_.+d_.*x_])^n_.,x_Symbol] :=
  Csc[c+d*x]^m*Sin[c+d*x]^m*Int[(A+C*Sin[c+d*x]^2)*(a+b*Sin[c+d*x])^n/Sin[c+d*x]^m,x] /;
FreeQ[{a,b,c,d,A,C,m,n},x] && Not[IntegerQ[m]]


(* ::Code:: *)
Int[csc[c_.+d_.*x_]^m_*sin[c_.+d_.*x_]^q_.*(A_.+B_.*sin[c_.+d_.*x_]+C_.*sin[c_.+d_.*x_]^2),x_Symbol] :=
  Csc[c+d*x]^m*Sin[c+d*x]^m*Int[Sin[c+d*x]^(q-m)*(A+B*Sin[c+d*x]+C*Sin[c+d*x]^2),x] /;
FreeQ[{c,d,A,B,C,m,q},x] && Not[IntegerQ[m]]


(* ::Code:: *)
Int[csc[c_.+d_.*x_]^m_*sin[c_.+d_.*x_]^q_.*(A_.+C_.*sin[c_.+d_.*x_]^2),x_Symbol] :=
  Csc[c+d*x]^m*Sin[c+d*x]^m*Int[Sin[c+d*x]^(q-m)*(A+C*Sin[c+d*x]^2),x] /;
FreeQ[{c,d,A,C,m,q},x] && Not[IntegerQ[m]]


(* ::Code:: *)
Int[csc[c_.+d_.*x_]^m_*sin[c_.+d_.*x_]^q_.*(A_.+B_.*sin[c_.+d_.*x_]+C_.*sin[c_.+d_.*x_]^2)*(a_.+b_.*sin[c_.+d_.*x_])^n_.,x_Symbol] :=
  Csc[c+d*x]^m*Sin[c+d*x]^m*Int[Sin[c+d*x]^(q-m)*(A+B*Sin[c+d*x]+C*Sin[c+d*x]^2)*(a+b*Sin[c+d*x])^n,x] /;
FreeQ[{a,b,c,d,A,B,C,m,n,q},x] && Not[IntegerQ[m]]


(* ::Code:: *)
Int[csc[c_.+d_.*x_]^m_*sin[c_.+d_.*x_]^q_.*(A_.+C_.*sin[c_.+d_.*x_]^2)*(a_.+b_.*sin[c_.+d_.*x_])^n_.,x_Symbol] :=
  Csc[c+d*x]^m*Sin[c+d*x]^m*Int[Sin[c+d*x]^(q-m)*(A+C*Sin[c+d*x]^2)*(a+b*Sin[c+d*x])^n,x] /;
FreeQ[{a,b,c,d,A,C,m,n,q},x] && Not[IntegerQ[m]]


(* ::Code:: *)
Int[(A_+B_.*csc[c_.+d_.*x_]+C_.*csc[c_.+d_.*x_]^2)*(a_.+b_.*sin[c_.+d_.*x_])^n_.,x_Symbol] :=
  Int[(C+B*Sin[c+d*x]+A*Sin[c+d*x]^2)*(a+b*Sin[c+d*x])^n/Sin[c+d*x]^2,x] /;
FreeQ[{a,b,c,d,A,B,C,n},x]


(* ::Code:: *)
Int[(A_+C_.*csc[c_.+d_.*x_]^2)*(a_.+b_.*sin[c_.+d_.*x_])^n_.,x_Symbol] :=
  Int[(C+A*Sin[c+d*x]^2)*(a+b*Sin[c+d*x])^n/Sin[c+d*x]^2,x] /;
FreeQ[{a,b,c,d,A,C,n},x]


(* ::Code:: *)
Int[sin[c_.+d_.*x_]^m_.*(A_+B_.*csc[c_.+d_.*x_]+C_.*csc[c_.+d_.*x_]^2)*(a_.+b_.*sin[c_.+d_.*x_])^n_.,x_Symbol] :=
  Int[Sin[c+d*x]^(m-2)*(C+B*Sin[c+d*x]+A*Sin[c+d*x]^2)*(a+b*Sin[c+d*x])^n,x] /;
FreeQ[{a,b,c,d,A,B,C,m,n},x]


(* ::Code:: *)
Int[sin[c_.+d_.*x_]^m_.*(A_+C_.*csc[c_.+d_.*x_]^2)*(a_.+b_.*sin[c_.+d_.*x_])^n_.,x_Symbol] :=
  Int[Sin[c+d*x]^(m-2)*(C+A*Sin[c+d*x]^2)*(a+b*Sin[c+d*x])^n,x] /;
FreeQ[{a,b,c,d,A,C,m,n},x]


(* ::Code:: *)
Int[csc[c_.+d_.*x_]^m_*(A_.+B_.*csc[c_.+d_.*x_]+C_.*csc[c_.+d_.*x_]^2)*(a_.+b_.*sin[c_.+d_.*x_])^n_.,x_Symbol] :=
  Csc[c+d*x]^m*Sin[c+d*x]^m*Int[(A+B*Csc[c+d*x]+C*Csc[c+d*x]^2)*(a+b*Sin[c+d*x])^n/Sin[c+d*x]^m,x] /;
FreeQ[{a,b,c,d,A,B,C,m,n},x] && Not[IntegerQ[m]]


(* ::Code:: *)
Int[csc[c_.+d_.*x_]^m_*(A_.+C_.*csc[c_.+d_.*x_]^2)*(a_.+b_.*sin[c_.+d_.*x_])^n_.,x_Symbol] :=
  Csc[c+d*x]^m*Sin[c+d*x]^m*Int[(A+C*Csc[c+d*x]^2)*(a+b*Sin[c+d*x])^n/Sin[c+d*x]^m,x] /;
FreeQ[{a,b,c,d,A,C,m,n},x] && Not[IntegerQ[m]]


(* ::Code:: *)
Int[csc[c_.+d_.*x_]^m_*sin[c_.+d_.*x_]^q_.*(A_+B_.*csc[c_.+d_.*x_]+C_.*csc[c_.+d_.*x_]^2)*(a_.+b_.*sin[c_.+d_.*x_])^n_.,x_Symbol] :=
  Csc[c+d*x]^m*Sin[c+d*x]^m*Int[Sin[c+d*x]^(q-m)*(A+B*Csc[c+d*x]+C*Csc[c+d*x]^2)*(a+b*Sin[c+d*x])^n,x] /;
FreeQ[{a,b,c,d,A,B,C,m,n},x] && Not[IntegerQ[m]]


(* ::Code:: *)
Int[csc[c_.+d_.*x_]^m_*sin[c_.+d_.*x_]^q_.*(A_+C_.*csc[c_.+d_.*x_]^2)*(a_.+b_.*sin[c_.+d_.*x_])^n_.,x_Symbol] :=
  Csc[c+d*x]^m*Sin[c+d*x]^m*Int[Sin[c+d*x]^(q-m)*(A+C*Csc[c+d*x]^2)*(a+b*Sin[c+d*x])^n,x] /;
FreeQ[{a,b,c,d,A,C,m,n},x] && Not[IntegerQ[m]]


(* ::Code:: *)
Int[(A_*csc[c_.+d_.*x_]+B_+C_.*sin[c_.+d_.*x_])*(a_.+b_.*sin[c_.+d_.*x_])^n_.,x_Symbol] :=
  Int[Csc[c+d*x]*(A+B*Sin[c+d*x]+C*Sin[c+d*x]^2)*(a+b*Sin[c+d*x])^n,x] /;
FreeQ[{a,b,c,d,A,B,C,n},x]


(* ::Code:: *)
Int[(A_*csc[c_.+d_.*x_]+C_.*sin[c_.+d_.*x_])*(a_.+b_.*sin[c_.+d_.*x_])^n_.,x_Symbol] :=
  Int[Csc[c+d*x]*(A+C*Sin[c+d*x]^2)*(a+b*Sin[c+d*x])^n,x] /;
FreeQ[{a,b,c,d,A,C,n},x]


(* ::Code:: *)
Int[csc[c_.+d_.*x_]^m_.*sin[c_.+d_.*x_]^q_.*(A_*csc[c_.+d_.*x_]+B_+C_.*sin[c_.+d_.*x_]),x_Symbol] :=
  Int[Csc[c+d*x]^(m+1)*Sin[c+d*x]^q*(A+B*Sin[c+d*x]+C*Sin[c+d*x]^2),x] /;
FreeQ[{c,d,A,B,C,m,q},x]


(* ::Code:: *)
Int[csc[c_.+d_.*x_]^m_.*sin[c_.+d_.*x_]^q_.*(A_*csc[c_.+d_.*x_]+C_.*sin[c_.+d_.*x_]),x_Symbol] :=
  Int[Csc[c+d*x]^(m+1)*Sin[c+d*x]^q*(A+C*Sin[c+d*x]^2),x] /;
FreeQ[{c,d,A,C,m,q},x]


(* ::Code:: *)
Int[sin[c_.+d_.*x_]^m_.*(A_*csc[c_.+d_.*x_]+B_+C_.*sin[c_.+d_.*x_]),x_Symbol] :=
  Int[Sin[c+d*x]^(m-1)*(A+B*Sin[c+d*x]+C*Sin[c+d*x]^2),x] /;
FreeQ[{c,d,A,B,C,m},x]


(* ::Code:: *)
Int[sin[c_.+d_.*x_]^m_.*(A_*csc[c_.+d_.*x_]+C_.*sin[c_.+d_.*x_]),x_Symbol] :=
  Int[Sin[c+d*x]^(m-1)*(A+C*Sin[c+d*x]^2),x] /;
FreeQ[{c,d,A,C,m},x]


(* ::Code:: *)
Int[csc[c_.+d_.*x_]^m_.*(A_*csc[c_.+d_.*x_]+B_+C_.*sin[c_.+d_.*x_]),x_Symbol] :=
  Int[Csc[c+d*x]^(m+1)*(A+B*Sin[c+d*x]+C*Sin[c+d*x]^2),x] /;
FreeQ[{c,d,A,B,C,m},x]


(* ::Code:: *)
Int[csc[c_.+d_.*x_]^m_.*(A_*csc[c_.+d_.*x_]+C_.*sin[c_.+d_.*x_]),x_Symbol] :=
  Int[Csc[c+d*x]^(m+1)*(A+C*Sin[c+d*x]^2),x] /;
FreeQ[{c,d,A,C,m},x]


(* ::Code:: *)
Int[csc[c_.+d_.*x_]^m_.*sin[c_.+d_.*x_]^q_.*(A_*csc[c_.+d_.*x_]+B_+C_.*sin[c_.+d_.*x_])*(a_.+b_.*sin[c_.+d_.*x_])^n_.,x_Symbol] :=
  Int[Csc[c+d*x]^(m+1)*Sin[c+d*x]^q*(A+B*Sin[c+d*x]+C*Sin[c+d*x]^2)*(a+b*Sin[c+d*x])^n,x] /;
FreeQ[{a,b,c,d,A,B,C,m,n,q},x]


(* ::Code:: *)
Int[csc[c_.+d_.*x_]^m_.*sin[c_.+d_.*x_]^q_.*(A_*csc[c_.+d_.*x_]+C_.*sin[c_.+d_.*x_])*(a_.+b_.*sin[c_.+d_.*x_])^n_.,x_Symbol] :=
  Int[Csc[c+d*x]^(m+1)*Sin[c+d*x]^q*(A+C*Sin[c+d*x]^2)*(a+b*Sin[c+d*x])^n,x] /;
FreeQ[{a,b,c,d,A,C,m,n,q},x]


(* ::Code:: *)
Int[sin[c_.+d_.*x_]^m_.*(A_*csc[c_.+d_.*x_]+B_+C_.*sin[c_.+d_.*x_])*(a_.+b_.*sin[c_.+d_.*x_])^n_.,x_Symbol] :=
  Int[Sin[c+d*x]^(m-1)*(A+B*Sin[c+d*x]+C*Sin[c+d*x]^2)*(a+b*Sin[c+d*x])^n,x] /;
FreeQ[{a,b,c,d,A,B,C,m,n},x]


(* ::Code:: *)
Int[sin[c_.+d_.*x_]^m_.*(A_*csc[c_.+d_.*x_]+C_.*sin[c_.+d_.*x_])*(a_.+b_.*sin[c_.+d_.*x_])^n_.,x_Symbol] :=
  Int[Sin[c+d*x]^(m-1)*(A+C*Sin[c+d*x]^2)*(a+b*Sin[c+d*x])^n,x] /;
FreeQ[{a,b,c,d,A,C,m,n},x]


(* ::Code:: *)
Int[csc[c_.+d_.*x_]^m_.*(A_*csc[c_.+d_.*x_]+B_+C_.*sin[c_.+d_.*x_])*(a_.+b_.*sin[c_.+d_.*x_])^n_.,x_Symbol] :=
  Int[Csc[c+d*x]^(m+1)*(A+B*Sin[c+d*x]+C*Sin[c+d*x]^2)*(a+b*Sin[c+d*x])^n,x] /;
FreeQ[{a,b,c,d,A,B,C,m,n},x]


(* ::Code:: *)
Int[csc[c_.+d_.*x_]^m_.*(A_*csc[c_.+d_.*x_]+C_.*sin[c_.+d_.*x_])*(a_.+b_.*sin[c_.+d_.*x_])^n_.,x_Symbol] :=
  Int[Csc[c+d*x]^(m+1)*(A+C*Sin[c+d*x]^2)*(a+b*Sin[c+d*x])^n,x] /;
FreeQ[{a,b,c,d,A,C,m,n},x]


(* ::Code:: *)
Int[(A_*sin[c_.+d_.*x_]^p_.+B_.*sin[c_.+d_.*x_]^p1_.+C_.*sin[c_.+d_.*x_]^p2_.)*(a_.+b_.*sin[c_.+d_.*x_])^n_.,x_Symbol] :=
  Int[Sin[c+d*x]^p*(A+B*Sin[c+d*x]+C*Sin[c+d*x]^2)*(a+b*Sin[c+d*x])^n,x] /;
FreeQ[{a,b,c,d,A,B,C,n,p},x] && ZeroQ[p1-(p+1)] && ZeroQ[p2-(p+2)]


(* ::Code:: *)
Int[(A_*sin[c_.+d_.*x_]^p_.+C_.*sin[c_.+d_.*x_]^p2_.)*(a_.+b_.*sin[c_.+d_.*x_])^n_.,x_Symbol] :=
  Int[Sin[c+d*x]^p*(A+C*Sin[c+d*x]^2)*(a+b*Sin[c+d*x])^n,x] /;
FreeQ[{a,b,c,d,A,C,n,p},x] && ZeroQ[p2-(p+2)]


(* ::Code:: *)
Int[csc[c_.+d_.*x_]^m_.*sin[c_.+d_.*x_]^q_.*(A_*sin[c_.+d_.*x_]^p_.+B_.*sin[c_.+d_.*x_]^p1_.+C_.*sin[c_.+d_.*x_]^p2_.),x_Symbol] :=
  Int[Csc[c+d*x]^m*Sin[c+d*x]^(p+q)*(A+B*Sin[c+d*x]+C*Sin[c+d*x]^2),x] /;
FreeQ[{c,d,A,B,C,m,p,q},x] && ZeroQ[p1-(p+1)] && ZeroQ[p2-(p+2)]


(* ::Code:: *)
Int[csc[c_.+d_.*x_]^m_.*sin[c_.+d_.*x_]^q_.*(A_*sin[c_.+d_.*x_]^p_.+C_.*sin[c_.+d_.*x_]^p2_.),x_Symbol] :=
  Int[Csc[c+d*x]^m*Sin[c+d*x]^(p+q)*(A+C*Sin[c+d*x]^2),x] /;
FreeQ[{c,d,A,C,m,p,q},x] && ZeroQ[p2-(p+2)]


(* ::Code:: *)
Int[sin[c_.+d_.*x_]^m_.*(A_*sin[c_.+d_.*x_]^p_.+B_.*sin[c_.+d_.*x_]^p1_.+C_.*sin[c_.+d_.*x_]^p2_.),x_Symbol] :=
  Int[Sin[c+d*x]^(m+p)*(A+B*Sin[c+d*x]+C*Sin[c+d*x]^2),x] /;
FreeQ[{c,d,A,B,C,m,p},x] && ZeroQ[p1-(p+1)] && ZeroQ[p2-(p+2)]


(* ::Code:: *)
Int[sin[c_.+d_.*x_]^m_.*(A_*sin[c_.+d_.*x_]^p_.+C_.*sin[c_.+d_.*x_]^p2_.),x_Symbol] :=
  Int[Sin[c+d*x]^(m+p)*(A+C*Sin[c+d*x]^2),x] /;
FreeQ[{c,d,A,C,m,p},x] && ZeroQ[p2-(p+2)]


(* ::Code:: *)
Int[csc[c_.+d_.*x_]^m_.*(A_*sin[c_.+d_.*x_]^p_.+B_.*sin[c_.+d_.*x_]^p1_.+C_.*sin[c_.+d_.*x_]^p2_.),x_Symbol] :=
  Int[Csc[c+d*x]^m*Sin[c+d*x]^p*(A+B*Sin[c+d*x]+C*Sin[c+d*x]^2),x] /;
FreeQ[{c,d,A,B,C,m,p},x] && ZeroQ[p1-(p+1)] && ZeroQ[p2-(p+2)]


(* ::Code:: *)
Int[csc[c_.+d_.*x_]^m_.*(A_*sin[c_.+d_.*x_]^p_.+C_.*sin[c_.+d_.*x_]^p2_.),x_Symbol] :=
  Int[Csc[c+d*x]^m*Sin[c+d*x]^p*(A+C*Sin[c+d*x]^2),x] /;
FreeQ[{c,d,A,C,m,p},x] && ZeroQ[p2-(p+2)]


(* ::Code:: *)
Int[csc[c_.+d_.*x_]^m_.*sin[c_.+d_.*x_]^q_.*(A_*sin[c_.+d_.*x_]^p_.+B_.*sin[c_.+d_.*x_]^p1_.+C_.*sin[c_.+d_.*x_]^p2_.)*
	(a_.+b_.*sin[c_.+d_.*x_])^n_.,x_Symbol] :=
  Int[Csc[c+d*x]^m*Sin[c+d*x]^(p+q)*(A+B*Sin[c+d*x]+C*Sin[c+d*x]^2)*(a+b*Sin[c+d*x])^n,x] /;
FreeQ[{a,b,c,d,A,B,C,m,n,p,q},x] && ZeroQ[p1-(p+1)] && ZeroQ[p2-(p+2)]


(* ::Code:: *)
Int[csc[c_.+d_.*x_]^m_.*sin[c_.+d_.*x_]^q_.*(A_*sin[c_.+d_.*x_]^p_.+C_.*sin[c_.+d_.*x_]^p2_.)*
	(a_.+b_.*sin[c_.+d_.*x_])^n_.,x_Symbol] :=
  Int[Csc[c+d*x]^m*Sin[c+d*x]^(p+q)*(A+C*Sin[c+d*x]^2)*(a+b*Sin[c+d*x])^n,x] /;
FreeQ[{a,b,c,d,A,C,m,n,p,q},x] && ZeroQ[p2-(p+2)]


(* ::Code:: *)
Int[sin[c_.+d_.*x_]^m_.*(A_*sin[c_.+d_.*x_]^p_.+B_.*sin[c_.+d_.*x_]^p1_.+C_.*sin[c_.+d_.*x_]^p2_.)*(a_.+b_.*sin[c_.+d_.*x_])^n_.,x_Symbol] :=
  Int[Sin[c+d*x]^(m+p)*(A+B*Sin[c+d*x]+C*Sin[c+d*x]^2)*(a+b*Sin[c+d*x])^n,x] /;
FreeQ[{a,b,c,d,A,B,C,m,n,p},x] && ZeroQ[p1-(p+1)] && ZeroQ[p2-(p+2)]


(* ::Code:: *)
Int[sin[c_.+d_.*x_]^m_.*(A_*sin[c_.+d_.*x_]^p_.+C_.*sin[c_.+d_.*x_]^p2_.)*(a_.+b_.*sin[c_.+d_.*x_])^n_.,x_Symbol] :=
  Int[Sin[c+d*x]^(m+p)*(A+C*Sin[c+d*x]^2)*(a+b*Sin[c+d*x])^n,x] /;
FreeQ[{a,b,c,d,A,C,m,n,p},x] && ZeroQ[p2-(p+2)]


(* ::Code:: *)
Int[csc[c_.+d_.*x_]^m_.*(A_*sin[c_.+d_.*x_]^p_.+B_.*sin[c_.+d_.*x_]^p1_.+C_.*sin[c_.+d_.*x_]^p2_.)*(a_.+b_.*sin[c_.+d_.*x_])^n_.,x_Symbol] :=
  Int[Csc[c+d*x]^m*Sin[c+d*x]^p*(A+B*Sin[c+d*x]+C*Sin[c+d*x]^2)*(a+b*Sin[c+d*x])^n,x] /;
FreeQ[{a,b,c,d,A,B,C,m,n,p},x] && ZeroQ[p1-(p+1)] && ZeroQ[p2-(p+2)]


(* ::Code:: *)
Int[csc[c_.+d_.*x_]^m_.*(A_*sin[c_.+d_.*x_]^p_.+C_.*sin[c_.+d_.*x_]^p2_.)*(a_.+b_.*sin[c_.+d_.*x_])^n_.,x_Symbol] :=
  Int[Csc[c+d*x]^m*Sin[c+d*x]^p*(A+C*Sin[c+d*x]^2)*(a+b*Sin[c+d*x])^n,x] /;
FreeQ[{a,b,c,d,A,C,m,n,p},x] && ZeroQ[p2-(p+2)]


(* ::Code:: *)
Int[(A_*csc[c_.+d_.*x_]^p_.+B_.*csc[c_.+d_.*x_]^p1_.+C_.*csc[c_.+d_.*x_]^p2_.)*(a_.+b_.*sin[c_.+d_.*x_])^n_.,x_Symbol] :=
  Int[Csc[c+d*x]^p*(A+B*Csc[c+d*x]+C*Csc[c+d*x]^2)*(a+b*Sin[c+d*x])^n,x] /;
FreeQ[{a,b,c,d,A,B,C,n,p},x] && ZeroQ[p1-(p+1)] && ZeroQ[p2-(p+2)]


(* ::Code:: *)
Int[(A_*csc[c_.+d_.*x_]^p_.+C_.*csc[c_.+d_.*x_]^p2_.)*(a_.+b_.*sin[c_.+d_.*x_])^n_.,x_Symbol] :=
  Int[Csc[c+d*x]^p*(A+C*Csc[c+d*x]^2)*(a+b*Sin[c+d*x])^n,x] /;
FreeQ[{a,b,c,d,A,C,n,p},x] && ZeroQ[p2-(p+2)]


(* ::Code:: *)
Int[csc[c_.+d_.*x_]^m_.*sin[c_.+d_.*x_]^q_.*(A_*csc[c_.+d_.*x_]^p_.+B_.*csc[c_.+d_.*x_]^p1_.+C_.*csc[c_.+d_.*x_]^p2_.),x_Symbol] :=
  Int[Csc[c+d*x]^(m+p)*Sin[c+d*x]^q*(A+B*Csc[c+d*x]+C*Csc[c+d*x]^2),x] /;
FreeQ[{c,d,A,B,C,m,p,q},x] && ZeroQ[p1-(p+1)] && ZeroQ[p2-(p+2)]


(* ::Code:: *)
Int[csc[c_.+d_.*x_]^m_.*sin[c_.+d_.*x_]^q_.*(A_*csc[c_.+d_.*x_]^p_.+C_.*csc[c_.+d_.*x_]^p2_.),x_Symbol] :=
  Int[Csc[c+d*x]^(m+p)*Sin[c+d*x]^q*(A+C*Csc[c+d*x]^2),x] /;
FreeQ[{c,d,A,C,m,p,q},x] && ZeroQ[p2-(p+2)]


(* ::Code:: *)
Int[sin[c_.+d_.*x_]^m_.*(A_*csc[c_.+d_.*x_]^p_.+B_.*csc[c_.+d_.*x_]^p1_.+C_.*csc[c_.+d_.*x_]^p2_.),x_Symbol] :=
  Int[Csc[c+d*x]^p*Sin[c+d*x]^m*(A+B*Csc[c+d*x]+C*Csc[c+d*x]^2),x] /;
FreeQ[{c,d,A,B,C,m,p},x] && ZeroQ[p1-(p+1)] && ZeroQ[p2-(p+2)]


(* ::Code:: *)
Int[sin[c_.+d_.*x_]^m_.*(A_*csc[c_.+d_.*x_]^p_.+C_.*csc[c_.+d_.*x_]^p2_.),x_Symbol] :=
  Int[Csc[c+d*x]^p*Sin[c+d*x]^m*(A+C*Csc[c+d*x]^2),x] /;
FreeQ[{c,d,A,C,m,p},x] && ZeroQ[p2-(p+2)]


(* ::Code:: *)
Int[csc[c_.+d_.*x_]^m_.*(A_*csc[c_.+d_.*x_]^p_.+B_.*csc[c_.+d_.*x_]^p1_.+C_.*csc[c_.+d_.*x_]^p2_.),x_Symbol] :=
  Int[Csc[c+d*x]^(m+p)*(A+B*Csc[c+d*x]+C*Csc[c+d*x]^2),x] /;
FreeQ[{c,d,A,B,C,m,p},x] && ZeroQ[p1-(p+1)] && ZeroQ[p2-(p+2)]


(* ::Code:: *)
Int[csc[c_.+d_.*x_]^m_.*(A_*csc[c_.+d_.*x_]^p_.+C_.*csc[c_.+d_.*x_]^p2_.),x_Symbol] :=
  Int[Csc[c+d*x]^(m+p)*(A+C*Csc[c+d*x]^2),x] /;
FreeQ[{c,d,A,C,m,p},x] && ZeroQ[p2-(p+2)]


(* ::Code:: *)
Int[csc[c_.+d_.*x_]^m_.*sin[c_.+d_.*x_]^q_.*(A_*csc[c_.+d_.*x_]^p_.+B_.*csc[c_.+d_.*x_]^p1_.+C_.*csc[c_.+d_.*x_]^p2_.)*
	(a_.+b_.*sin[c_.+d_.*x_])^n_.,x_Symbol] :=
  Int[Csc[c+d*x]^(m+p)*Sin[c+d*x]^q*(A+B*Csc[c+d*x]+C*Csc[c+d*x]^2)*(a+b*Sin[c+d*x])^n,x] /;
FreeQ[{a,b,c,d,A,B,C,m,n,p,q},x] && ZeroQ[p1-(p+1)] && ZeroQ[p2-(p+2)]


(* ::Code:: *)
Int[csc[c_.+d_.*x_]^m_.*sin[c_.+d_.*x_]^q_.*(A_*csc[c_.+d_.*x_]^p_.+C_.*csc[c_.+d_.*x_]^p2_.)*
	(a_.+b_.*sin[c_.+d_.*x_])^n_.,x_Symbol] :=
  Int[Csc[c+d*x]^(m+p)*Sin[c+d*x]^q*(A+C*Csc[c+d*x]^2)*(a+b*Sin[c+d*x])^n,x] /;
FreeQ[{a,b,c,d,A,C,m,n,p,q},x] && ZeroQ[p2-(p+2)]


(* ::Code:: *)
Int[sin[c_.+d_.*x_]^m_.*(A_*csc[c_.+d_.*x_]^p_.+B_.*csc[c_.+d_.*x_]^p1_.+C_.*csc[c_.+d_.*x_]^p2_.)*(a_.+b_.*sin[c_.+d_.*x_])^n_.,x_Symbol] :=
  Int[Csc[c+d*x]^p*Sin[c+d*x]^m*(A+B*Csc[c+d*x]+C*Csc[c+d*x]^2)*(a+b*Sin[c+d*x])^n,x] /;
FreeQ[{a,b,c,d,A,B,C,m,n,p},x] && ZeroQ[p1-(p+1)] && ZeroQ[p2-(p+2)]


(* ::Code:: *)
Int[sin[c_.+d_.*x_]^m_.*(A_*csc[c_.+d_.*x_]^p_.+C_.*csc[c_.+d_.*x_]^p2_.)*(a_.+b_.*sin[c_.+d_.*x_])^n_.,x_Symbol] :=
  Int[Csc[c+d*x]^p*Sin[c+d*x]^m*(A+C*Csc[c+d*x]^2)*(a+b*Sin[c+d*x])^n,x] /;
FreeQ[{a,b,c,d,A,C,m,n,p},x] && ZeroQ[p2-(p+2)]


(* ::Code:: *)
Int[csc[c_.+d_.*x_]^m_.*(A_*csc[c_.+d_.*x_]^p_.+B_.*csc[c_.+d_.*x_]^p1_.+C_.*csc[c_.+d_.*x_]^p2_.)*
	(a_.+b_.*sin[c_.+d_.*x_])^n_.,x_Symbol] :=
  Int[Csc[c+d*x]^(m+p)*(A+B*Csc[c+d*x]+C*Csc[c+d*x]^2)*(a+b*Sin[c+d*x])^n,x] /;
FreeQ[{a,b,c,d,A,B,C,m,n,p},x] && ZeroQ[p1-(p+1)] && ZeroQ[p2-(p+2)]


(* ::Code:: *)
Int[csc[c_.+d_.*x_]^m_.*(A_*csc[c_.+d_.*x_]^p_.+C_.*csc[c_.+d_.*x_]^p2_.)*
	(a_.+b_.*sin[c_.+d_.*x_])^n_.,x_Symbol] :=
  Int[Csc[c+d*x]^(m+p)*(A+C*Csc[c+d*x]^2)*(a+b*Sin[c+d*x])^n,x] /;
FreeQ[{a,b,c,d,A,C,m,n,p},x] && ZeroQ[p2-(p+2)]


(* ::Code:: *)
Int[Sqrt[a_+b_.*sin[c_.+d_.*x_]]/(Sqrt[sin[c_.+d_.*x_]]*(A_+B_.*sin[c_.+d_.*x_])),x_Symbol] :=
  -Sqrt[a+b]/(A*d)*EllipticE[ArcSin[Cos[c+d*x]/(1+Sin[c+d*x])],-(a-b)/(a+b)] /;
FreeQ[{a,b,c,d,A,B},x] && ZeroQ[B-A] && PositiveQ[b] && PositiveQ[b^2-a^2]


(* ::Code:: *)
Int[Sqrt[a_+b_.*sin[c_.+d_.*x_]]/(Sqrt[sin[c_.+d_.*x_]]*(A_+B_.*sin[c_.+d_.*x_])),x_Symbol] :=
  -(a+b)*Sqrt[1+Sin[c+d*x]]*Sqrt[(a+b*Sin[c+d*x])/((a+b)*(1+Sin[c+d*x]))]/(A*d*Sqrt[a+b*Sin[c+d*x]])*
    EllipticE[ArcSin[Cos[c+d*x]/(1+Sin[c+d*x])],-(a-b)/(a+b)] /;
FreeQ[{a,b,c,d,A,B},x] && ZeroQ[B-A] && NonzeroQ[a^2-b^2]


(* ::Code:: *)
(* Int[Sqrt[a_+b_.*sin[c_.+d_.*x_]]/(Sqrt[sin[c_.+d_.*x_]]*(A_+B_.*sin[c_.+d_.*x_])),x_Symbol] :=
  -Sqrt[a+b*Sin[c+d*x]]/(A*d*Sqrt[1+Sin[c+d*x]]*Sqrt[(a+b*Sin[c+d*x])/((a+b)*(1+Sin[c+d*x]))])*
    EllipticE[ArcSin[Cos[c+d*x]/(1+Sin[c+d*x])],-(a-b)/(a+b)] /;
FreeQ[{a,b,c,d,A,B},x] && ZeroQ[B-A] && NonzeroQ[a^2-b^2] *)


(* ::Code:: *)
Int[Sqrt[sin[c_.+d_.*x_]]/(Sqrt[a_.+b_.*sin[c_.+d_.*x_]]*(A_+B_.*sin[c_.+d_.*x_])),x_Symbol] :=
  a/(A*(a-b))*Int[1/(Sqrt[Sin[c+d*x]]*Sqrt[a+b*Sin[c+d*x]]),x] - 
  1/(a-b)*Int[Sqrt[a+b*Sin[c+d*x]]/(Sqrt[Sin[c+d*x]]*(A+B*Sin[c+d*x])),x] /;
FreeQ[{a,b,c,d,A,B},x] && ZeroQ[A-B] && NonzeroQ[a^2-b^2]



