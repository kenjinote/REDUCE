(setq infoellis (QUOTE (THIS IS the program ELLISEVOL in
 Codemist Standard Lisp to be run under Windows 98 and Linux!.
It calculates the Ellis evolution equations given the
 orthonormal tetrad representation of the metric and of the
 velocity field!. This program uses most of the functions existing
 in the program Ortocartan, and so it can be used only if Ortocartan
 had been read by Lisp before!.
In order to create a working overlay, this program should either be
made into a new overlay on top of Ortocartan or read into the
Ortocartan overlay during each session!.)))

(de MAKEVELO ( ) (PROG (V1 V2 V L MEM)
    (SETQ MEM (MEMQ (QUOTE UVELO) NOPRINT))
    (SETQ UVELO (GENSYM))
    (MKARRAY UVELO (LIST 4))
    (SETQ I 0)
    (SETQ V1 (LIST NIL))
    (SETQ V2 (LIST NIL NIL))
 A  (SETQ L NIL)
    (RPLACA V2 I)
    (MAPC LIND (FUNCTION (LAMBDA (LE) (PROGN
        (RPLACA V1 LE)
        (RPLACA (CDR V2) LE)
        (SETQ V (STIMES (LIST (PICKEL VMATRIX V1) (PICKEL IE V2))))
        (SETQ L (CONS V L))  ))))
    (SETQ L (SPLUS L))
    (SUBSALL (QUOTE L) (QUOTE UVELO) NIL (RPLACA V1 I) SIMPLSUBS)
    (PUTIN UVELO V1 L)
    (OR (EQN L 0) MEM (PROG2
        (INPRINT (QUOTE UVELO) (QUOTE (+)) V1 (QUOTE =) L)
        (TURNCAR)))
    (OR (EQN I 3) (PROG2 (SETQ I (ADD1 I))
                         (GO A)))
    (OR MEM (PROGN (TURNCAR) (TURNCAR) (TURNCAR) ))
    (SETQ LVELO (GENSYM))
    (MKARRAY LVELO (LIST 4))
    (SETQ I 0)
    (SETQ MEM (MEMQ (QUOTE LVELO) NOPRINT))
 B  (SETQ L NIL)
    (RPLACA (CDR V2) I)
    (MAPC LIND (FUNCTION (LAMBDA (LE) (PROGN
        (RPLACA V1 LE)
        (RPLACA V2 LE)
        (SETQ V (STIMES (LIST (PICKEL VMATRIX V1) (PICKEL EMATRIX V2))))
        (OR (EQN LE 0) (SETQ V (SMINUS V)))
        (SETQ L (CONS V L))  ))))
    (SETQ L (SPLUS L))
    (SUBSALL (QUOTE L) (QUOTE LVELO) NIL (RPLACA V1 I) SIMPLSUBS)
    (PUTIN LVELO V1 L)
    (OR (EQN L 0) MEM (PROG2
        (INPRINT (QUOTE LVELO) NIL V1 (QUOTE =) L)
        (TURNCAR)))
    (OR (EQN I 3) (PROG2 (SETQ I (ADD1 I))
                         (GO B)))
    (OR MEM (PROGN (TURNCAR) (TURNCAR) (TURNCAR) ))
                       ))
(de MAKEMETRIC ( ) (PROG (V R E1 E2 LIA LJB MEM)
    (SETQ MEM (MEMQ (QUOTE METRIC) NOPRINT))
    (RPLACA LAB 0)
    (RPLACA (CDR LAB) 0)
    (PUTIN RC LAB 1)
    (MAPC (CDR LIND) (FUNCTION (LAMBDA (I) (PROGN
        (RPLACA LAB I)
        (RPLACA (CDR LAB) I)
        (PUTIN RC LAB -1)) )))
    (MAPC LIND (FUNCTION (LAMBDA (I) (PROG2
        (RPLACA LAB I)
        (MAPC LIND (FUNCTION (LAMBDA (J) (OR (EQN I J) (PROG2
            (RPLACA (CDR LAB) J)
            (PUTIN RC LAB 0))) ))) ))))
    (SETQ METRIC (GENSYM))
    (MKARRAY METRIC (LIST 4 4))
    (SETQ LIA (LIST NIL NIL))
    (SETQ LJB (LIST NIL NIL))
    (MAPC LIND (FUNCTION (LAMBDA (A) (PROGN
        (RPLACA (CDR LIA) A)
        (RPLACA LAB A)
        (MAPC (MEMBER A LIND) (FUNCTION (LAMBDA (B) (PROG ( )
            (RPLACA (CDR LAB) B)
            (RPLACA (CDR LJB) B)
            (SETQ R 0)
            (MAPC LIND (FUNCTION (LAMBDA (I) (PROG2
                (RPLACA LIA I)
                (OR (EQN (SETQ E1 (PICKEL EMATRIX LIA)) 0) (PROG2
                    (RPLACA LIJ I)
                    (MAPC LIND (FUNCTION (LAMBDA (J) (PROG2
                        (RPLACA LJB J)
                        (OR (EQN (SETQ E2 (PICKEL EMATRIX LJB)) 0)(PROGN
                            (RPLACA (CDR LIJ) J)
                            (SETQ V (STIMES (LIST (PICKEL RC LIJ)
                                                                E1 E2)))
                            (OR (EQN V 0)
                                (SETQ R (SPLUSPARTS R V)))) ))))) ))))))
            (SUBSALL (QUOTE R) (QUOTE METRIC) NIL LAB SIMPLSUBS)
            (PUTIN METRIC LAB R)
            (AND (EQN R 0) (RETURN NIL))
            (OR MEM (PROG2
                (INPRINT (QUOTE METRIC) NIL LAB (QUOTE =) R)
                (TURNCAR))) )))) ))))
    (TIMEMESSAGE (QUOTE METRIC) NIL)
    (OR MEM (PROGN (TURNCAR) (TURNCAR) (TURNCAR) ))
    (MAPC (CDR LIND) (FUNCTION (LAMBDA (A) (PROGN
        (RPLACA LIJ A)
        (RPLACA (CDR LAB) A)
        (MAPC LIND (FUNCTION (LAMBDA (B) (AND (GREATERP A B) (PROGN
            (RPLACA (CDR LIJ) B)
            (RPLACA LAB B)
            (PUTIN METRIC LIJ (PICKEL METRIC LAB)) )) ))) ))))
      ))
(de MAKEINVMETRIC ( ) (PROG (E1 E2 MEM)
    (SETQ MEM (MEMQ (QUOTE INVMETRIC) NOPRINT))
    (SETQ INVMETRIC (GENSYM))
    (MKARRAY INVMETRIC (LIST 4 4))
    (SETQ V1 (LIST NIL NIL))
    (SETQ LKC (LIST NIL NIL))
    (MAPC LIND (FUNCTION (LAMBDA (A) (PROGN
        (RPLACA LAB A)
        (RPLACA (CDR LKC) A)
        (MAPC (MEMBER A LIND) (FUNCTION (LAMBDA (B) (PROG (V R)
            (RPLACA (CDR LAB) B)
            (RPLACA (CDR V1) B)
            (MAPC LIND (FUNCTION (LAMBDA (I) (PROG2
                (RPLACA LKC I)
                (OR (EQN (SETQ E1 (PICKEL UPIE LKC)) 0) (PROG2
                    (RPLACA LIJ I)
                    (MAPC LIND (FUNCTION (LAMBDA (J) (PROG2
                        (RPLACA V1 J)
                        (OR (EQN (SETQ E2 (PICKEL UPIE V1)) 0) (PROGN
                            (RPLACA (CDR LIJ) J)
                            (SETQ V (STIMES (LIST (PICKEL RC LIJ)
                                                                E1 E2)))
                            (SETQ R (CONS V R)) )) )))) )) ))))
            (SETQ R (SPLUS R))
            (SUBSALL (QUOTE R) (QUOTE INVMETRIC) NIL LAB SIMPLSUBS)
            (PUTIN INVMETRIC LAB R)
            (OR (EQN R 0) MEM (PROG2
                (INPRINT (QUOTE INVMETRIC) (QUOTE (+ +)) LAB (QUOTE =) R)
                (TURNCAR))) )))) ))))
    (TIMEMESSAGE (QUOTE INVMETRIC) NIL)
    (OR MEM (PROGN (TURNCAR) (TURNCAR) (TURNCAR) ))
    (MAPC (CDR LIND) (FUNCTION (LAMBDA (A) (PROGN
        (RPLACA LIJ A)
        (RPLACA (CDR LAB) A)
        (MAPC LIND (FUNCTION (LAMBDA (B) (AND (GREATERP A B) (PROGN
            (RPLACA (CDR LIJ) B)
            (RPLACA LAB B)
            (PUTIN INVMETRIC LIJ (PICKEL INVMETRIC LAB)) )) ))) ))))
      ))
(de MAKETIDAL (SOURCE) (PROG (CHECK MEM W V1)
    (SETQ MEM (MEMQ (COND
          ((EQ SOURCE (QUOTE LVELO))   (QUOTE VTIDA))
          (T   (QUOTE ATIDA))) NOPRINT))
    (COND ((EQ SOURCE (QUOTE LVELO))   (PROGN (SETQ V1 (QUOTE VTIDA))
                                              (SETQ VTIDA (GENSYM))
                                              (MKARRAY VTIDA (LIST 4 4))
                                              (SETQ W VTIDA)))
          ((EQ SOURCE (QUOTE LACCE))   (PROGN (SETQ V1 (QUOTE ATIDA))
                                              (SETQ ATIDA (GENSYM))
                                              (MKARRAY ATIDA (LIST 4 4))
                                              (SETQ W ATIDA)))
          (T   (ERROR (LIST
                  (QUOTE "THE FUNCTION *****/// MAKETIDAL ///*****")
                  (QUOTE "WAS CALLED WITH AN INADMISSIBLE ARGUMENT")
                  (QUOTE "*****") SOURCE)) ))
    (MAPC LIND (FUNCTION (LAMBDA (A) (PROGN
        (RPLACA LIJ A)
        (RPLACA (CDR LIJK) A)
        (MAPC LIND (FUNCTION (LAMBDA (B) (PROG (V)
            (RPLACA (CDR LIJ) B)
            (RPLACA (CDDR LIJK) B)
            (SETQ V (DERIV (NTH COORD (ADD1 B))
                    (PICKEL (EVAL SOURCE) (LIST A)) ))
            (SETQ V (CONS V NIL))
            (MAPC LIND (FUNCTION (LAMBDA (R) (PROG2
                (RPLACA LIJK R)
                (SETQ V (CONS (STIMES (LIST -1 (PICKEL CHRIS LIJK)
                           (PICKEL (EVAL SOURCE) (LIST R)) )) V)) ))))
            (SETQ V (SPLUS V))
            (SUBSALL (QUOTE V) V1 NIL LIJ SIMPLSUBS)
            (PUTIN W LIJ V)
            (OR (EQN V 0) (PROG2
                (SETQ CHECK T)
                (OR MEM (PROG2
                    (INPRINT V1 (QUOTE (- - -))
                         (LIST A (QUOTE !;) B) (QUOTE =) V)
                    (TURNCAR))) )) )))) ))))
    (OR CHECK
        (MESSAGE (LIST SOURCE (QUOTE "IS COVARIANTLY CONSTANT")) T))
    (TIMEMESSAGE (LIST (QUOTE "TIDAL MATRIX OF") SOURCE) T)
    (OR MEM (PROGN (TURNCAR) (TURNCAR) (TURNCAR) ))
    (RETURN CHECK)  ))
(de MAKEACCE ( ) (PROG (CHECK MEM)
    (SETQ UACCE (GENSYM))
    (MKARRAY UACCE (LIST 4))
    (SETQ MEM (MEMQ (QUOTE UACCE) NOPRINT))
    (MAPC LIND (FUNCTION (LAMBDA (A) (PROG (V V1 V2)
        (RPLACA LIJK A)
        (MAPC LIND (FUNCTION (LAMBDA (R) (PROGN
            (RPLACA (CDR LIJK) R)
            (SETQ V (CONS (STIMES (LIST
                          (DERIV (NTH COORD (ADD1 R))
                                 (PICKEL UVELO (SETQ V2 (LIST A))))
                          (SETQ V1 (PICKEL UVELO (LIST R))) )) V))
            (MAPC (MEMBER R LIND) (FUNCTION (LAMBDA (S) (PROG (W)
                (RPLACA (CDDR LIJK) S)
                (SETQ W (STIMES (LIST (PICKEL CHRIS LIJK) V1
                         (PICKEL UVELO (LIST S)) )))
                (OR (EQN R S) (SETQ W (STIMES (LIST 2 W))))
                (OR (EQN W 0) (SETQ V (CONS W V))) )))) ))))
        (SETQ V (SPLUS V))
        (SUBSALL (QUOTE V) (QUOTE UACCE) NIL (LIST A) SIMPLSUBS)
        (PUTIN UACCE V2 V)
        (OR (EQN V 0) (PROG2
            (SETQ CHECK T)
            (OR MEM (PROG2
                (INPRINT (QUOTE UACCE) (QUOTE (+)) V2 (QUOTE =) V)
                (TURNCAR))) )) ))))
    (OR MEM (PROGN (TURNCAR) (TURNCAR) (TURNCAR) ))
    (SETQ LACCE (GENSYM))
    (MKARRAY LACCE (LIST 4))
    (OR CHECK (PROGN
        (OR MEM (PROGN (MESSAGE (QUOTE "ACCELERATION = 0") T)
                       (TURNCAR) (TURNCAR) (TURNCAR) ))
        (MAPC LIND (FUNCTION (LAMBDA (I) (PUTIN LACCE (LIST I) 0) )))
        (RETURN CHECK)))
    (SETQ MEM (MEMQ (QUOTE LACCE) NOPRINT))
    (MAPC LIND (FUNCTION (LAMBDA (A) (PROG (V V1)
        (RPLACA LIJ A)
        (MAPC LIND (FUNCTION (LAMBDA (R) (PROG (W)
            (RPLACA (CDR LIJ) R)
            (SETQ W (STIMES (LIST (PICKEL METRIC LIJ)
                                  (PICKEL UACCE (LIST R)) )))
            (OR (EQN W 0) (SETQ V (CONS W V))) ))))
        (SETQ V (COND (V   (SPLUS V))
                      (T   0)))
        (SUBSALL (QUOTE V) (QUOTE LACCE) NIL
                 (SETQ V1 (LIST A)) SIMPLSUBS)
        (PUTIN LACCE V1 V)
        (OR MEM (EQN V 0) (PROG2
            (INPRINT (QUOTE LACCE) NIL V1 (QUOTE =) V)
            (TURNCAR))) ))))
    (OR MEM (PROGN (TURNCAR) (TURNCAR) (TURNCAR) ))
    (RETURN CHECK)  ))
(de MAKEROT ( ) (PROG (CHECK MEM W)
    (SETQ ROTDD (GENSYM))
    (MKARRAY ROTDD (LIST 4 4))
    (SETQ MEM (MEMQ (QUOTE ROTDD) NOPRINT))
    (MAPC LIND (FUNCTION (LAMBDA (A) (OR (EQN A 3) (PROGN
        (RPLACA LIJ A)
        (MAPC (CDR (MEMBER A LIND)) (FUNCTION (LAMBDA (B) (PROG(V VA VB)
            (RPLACA (CDR LIJ) B)
            (SETQ VA (LIST A))
            (SETQ VB (LIST B))
            (SETQ V (STIMES (LIST (QUOTE (1 . 2))
               (SPLUS (LIST (DERIV (NTH COORD(ADD1 B))(PICKEL LVELO VA))
                  (SMINUS (DERIV (NTH COORD (ADD1 A))(PICKEL LVELO VB)))
                  (STIMES (LIST -1 (PICKEL LACCE VA) (PICKEL LVELO VB)))
                  (STIMES (LIST (PICKEL LACCE VB) (PICKEL LVELO VA)))
                         )) )))
            (SUBSALL (QUOTE V) (QUOTE ROTDD) NIL LIJ SIMPLSUBS)
        (PUTIN ROTDD LIJ V)
        (OR (EQN V 0) (PROG2
            (SETQ CHECK T)
            (OR MEM (PROG2
                (INPRINT (QUOTE ROTDD) NIL LIJ (QUOTE =) V)
                (TURNCAR))) )) )))) )) )))
    (TIMEMESSAGE (QUOTE ROTDD) NIL)
    (OR MEM (PROGN (TURNCAR) (TURNCAR) (TURNCAR) ))
    (SETQ ROTDU (GENSYM))
    (MKARRAY ROTDU (LIST 4 4))
    (OR CHECK (PROGN
        (OR MEM (PROGN (MESSAGE (QUOTE "ROTATION = 0") T)
                       (TURNCAR) (TURNCAR) (TURNCAR) ))
        (MAPC LIND (FUNCTION (LAMBDA (I) (PROGN
            (RPLACA LIJ I)
            (MAPC LIND (FUNCTION (LAMBDA (J) (OR (GREATERP J I) (PROG2
                (RPLACA (CDR LIJ) J)
                (PUTIN ROTDD LIJ 0))) )))
            (MAPC LIND (FUNCTION (LAMBDA (J) (PROG2
                (RPLACA (CDR LIJ) J)
                (PUTIN ROTDU LIJ 0) )))) ))))
        (SETQ ROT 0)
        (RETURN CHECK)))
    (AND (EQ STOP (QUOTE ROTDD)) (RETURN CHECK))
    (SETQ MEM (MEMQ (QUOTE ROTDU) NOPRINT))
    (SETQ LKC (LIST NIL NIL))
    (MAPC LIND (FUNCTION (LAMBDA (I) (PROGN
        (RPLACA LIJ I)
        (RPLACA (CDR LAB) I)
        (MAPC LIND (FUNCTION (LAMBDA (J) (OR (GREATERP J I) (PROGN
            (RPLACA (CDR LIJ) J)
            (RPLACA LAB J)
            (PUTIN ROTDD LIJ (COND ((EQN J I)   0)
                                   (T   (SMINUS (PICKEL ROTDD LAB)) )))
                   )) ))) ))))
    (TIMEMESSAGE (QUOTE ROTDD) T)
    (AND (EQ STOP (QUOTE ROTDD)) (RETUNRN CHECK))
    (MAPC LIND (FUNCTION (LAMBDA (A) (PROGN
        (RPLACA LKC A)
        (RPLACA LAB A)
        (MAPC LIND (FUNCTION (LAMBDA (B) (PROG (V)
            (RPLACA (CDR LAB) B)
            (RPLACA LIJ B)
            (MAPC LIND (FUNCTION (LAMBDA (R) (PROGN
                (RPLACA (CDR LIJ) R)
                (RPLACA (CDR LKC) R)
                (SETQ V (CONS (STIMES (LIST
                    (PICKEL INVMETRIC LIJ) (PICKEL ROTDD LKC))) V)) ))))
            (SETQ V (SPLUS V))
            (SUBSALL (QUOTE V) (QUOTE ROTDU) NIL LAB SIMPLSUBS)
        (PUTIN ROTDU LAB V)
        (OR (EQN V 0) MEM (PROG2
            (INPRINT (QUOTE ROTDU) (QUOTE (- +)) LAB (QUOTE =) V)
            (TURNCAR))) )))) ))))
    (TIMEMESSAGE (QUOTE ROTDU) T)
    (OR MEM (PROGN (TURNCAR) (TURNCAR) (TURNCAR) ))
    (AND (EQ STOP (QUOTE ROTDU)) (RETURN CHECK))
    (AND (MEMQ (QUOTE RAYCHAUDHURI) NOPRINT)
         (MEMQ (QUOTE ROTATION) NOPRINT)(MEMQ (QUOTE SHEAREVOL) NOPRINT)
         (RETURN CHECK))
    (SETQ W NIL)
    (SETQ MEM (MEMQ (QUOTE ROTATION) NOPRINT))
    (MAPC LIND (FUNCTION (LAMBDA (A) (PROGN
        (RPLACA LAB A)
        (RPLACA (CDR LIJ) A)
        (MAPC LIND (FUNCTION (LAMBDA (B) (PROGN
            (RPLACA (CDR LAB) B)
            (RPLACA LIJ B)
            (SETQ W (CONS (STIMES (LIST (QUOTE (-1 . 2))
                (PICKEL ROTDU LAB) (PICKEL ROTDU LIJ))) W)) )))) ))))
    (SETQ W (SPLUS W))
    (SUBSALL (QUOTE W) (QUOTE ROTATION) NIL NIL SIMPLSUBS)
    (SETQ ROT W)
    (OR MEM (PROG2
        (INPRINT (QUOTE "ROTATION SQUARED") NIL NIL (QUOTE =) ROT)
             (TURNCAR)))
    (TIMEMESSAGE (QUOTE "ROTATION SCALAR") NIL)
    (OR MEM (PROGN (TURNCAR) (TURNCAR) (TURNCAR) ))
    (RETURN CHECK)  ))
(de MAKESHEAR ( ) (PROG (CHECK MEM W)
    (SETQ PROJDD (GENSYM))
    (MKARRAY PROJDD (LIST 4 4))
    (SETQ MEM (MEMQ (QUOTE PROJDD) NOPRINT))
    (MAPC LIND (FUNCTION (LAMBDA (A) (PROG2
        (RPLACA LAB A)
        (MAPC (MEMBER A LIND) (FUNCTION (LAMBDA (B) (PROG(V)
            (RPLACA (CDR LAB) B)
            (SETQ V (SPLUS (LIST (PICKEL METRIC LAB)
                  (STIMES (LIST -1 (PICKEL LVELO (LIST A))
                                   (PICKEL LVELO (LIST B)) )) )))
            (SUBSALL (QUOTE V) (QUOTE PROJDD) NIL LAB SIMPLSUBS)
            (PUTIN PROJDD LAB V)
            (OR (EQN V 0) MEM (PROG2
                (INPRINT (QUOTE PROJDD) NIL LAB (QUOTE =) V)
                (TURNCAR))) )))) ))))
    (TIMEMESSAGE (QUOTE PROJDD) NIL)
    (OR MEM (PROGN (TURNCAR) (TURNCAR) (TURNCAR) ))
    (AND (EQ STOP (QUOTE PROJDD)) (RETUNRN CHECK))
    (MAPC (CDR LIND) (FUNCTION (LAMBDA (A) (PROGN
        (RPLACA LAB A)
        (RPLACA (CDR LIJ) A)
        (MAPC LIND (FUNCTION (LAMBDA (B) (AND (GREATERP A B) (PROGN
            (RPLACA (CDR LAB) B)
            (RPLACA LIJ A)
            (PUTIN PROJDD LAB (PICKEL PROJDD LIJ)) )) ))) ))))
    (TIMEMESSAGE (QUOTE PROJDD) T)
    (OR MEM (PROGN (TURNCAR) (TURNCAR) (TURNCAR) ))
    (SETQ PROJDU (GENSYM))
    (MKARRAY PROJDU (LIST 4 4))
    (SETQ MEM (MEMQ (QUOTE PROJDU) NOPRINT))
    (MAPC LIND (FUNCTION (LAMBDA (A) (PROG2
        (RPLACA LAB A)
        (MAPC LIND (FUNCTION (LAMBDA (B) (PROG (V)
            (RPLACA (CDR LAB) B)
            (SETQ V (STIMES (LIST -1 (PICKEL LVELO (LIST A))
                                  (PICKEL UVELO (LIST B)) )))
            (AND (EQN A B) (SETQ V (SPLUS (LIST 1 V)) ))
            (SUBSALL (QUOTE V) (QUOTE PROJDU) NIL LAB SIMPLSUBS)
        (PUTIN PROJDU LAB V)
        (OR (EQN V 0) MEM (PROG2
            (INPRINT (QUOTE PROJDU) (QUOTE (- +)) LAB (QUOTE =) V)
            (TURNCAR))) )))) ))))
    (TIMEMESSAGE (QUOTE PROJDU) NIL)
    (OR MEM (PROGN (TURNCAR) (TURNCAR) (TURNCAR) ))
    (AND (EQ STOP (QUOTE PROJDU)) (RETURN CHECK))
    (SETQ W NIL)
    (MAPC LIND (FUNCTION (LAMBDA (A) (PROG2
        (RPLACA LAB A)
        (MAPC LIND (FUNCTION (LAMBDA (B) (PROG2
            (RPLACA (CDR LAB) B)
            (SETQ W (CONS (STIMES (LIST (PICKEL INVMETRIC LAB)
                                      (PICKEL VTIDA LAB))) W)) )))) ))))
    (SETQ W (SPLUS W))
    (SUBSALL (QUOTE W) (QUOTE EXPANSION) NIL NIL SIMPLSUBS)
    (SETQ EXPA W)
    (SETQ MEM (MEMQ (QUOTE EXPANSION) NOPRINT))
    (OR MEM (PROGN
        (INPRINT (QUOTE "EXPANSION SCALAR") NIL NIL (QUOTE =) W)
        (TURNCAR) (TURNCAR) (TURNCAR)))
    (TIMEMESSAGE (QUOTE "EXPANSION SCALAR") NIL)
    (OR MEM (PROGN (TURNCAR) (TURNCAR) (TURNCAR) ))
    (AND (EQ STOP (QUOTE EXPANSION)) (RETURN CHECK))
    (SETQ SHEARDD (GENSYM))
    (MKARRAY SHEARDD (LIST 4 4))
    (SETQ MEM (MEMQ (QUOTE SHEARDD) NOPRINT))
    (MAPC LIND (FUNCTION (LAMBDA (A) (PROGN
        (RPLACA LAB A)
        (RPLACA (CDR LIJ) A)
        (MAPC (MEMBER A LIND) (FUNCTION (LAMBDA (B) (PROG(V)
            (RPLACA (CDR LAB) B)
            (RPLACA LIJ B)
            (SETQ V (SPLUS (LIST
                (STIMES (LIST (QUOTE (1 . 2)) (PICKEL VTIDA LAB)))
                (STIMES (LIST (QUOTE (1 . 2)) (PICKEL VTIDA LIJ)))
                (STIMES (LIST (QUOTE (-1 . 2)) (PICKEL LACCE (LIST A))
                              (PICKEL LVELO (LIST B)) ))
                (STIMES (LIST (QUOTE (-1 . 2)) (PICKEL LACCE (LIST B))
                              (PICKEL LVELO (LIST A)) ))
                (STIMES (LIST (QUOTE (-1 . 3)) EXPA
                              (PICKEL PROJDD LAB))) )))
            (SUBSALL (QUOTE V) (QUOTE SHEARDD) NIL LAB SIMPLSUBS)
            (PUTIN SHEARDD LAB V)
            (OR (EQN V 0) (PROG2
                (SETQ CHECK T)
                (OR MEM (PROG2
                    (INPRINT (QUOTE SHEARDD) NIL LAB (QUOTE =) V)
                    (TURNCAR))) )) )))) ))))
    (TIMEMESSAGE (QUOTE SHEARDD) NIL)
    (OR MEM (PROGN (TURNCAR) (TURNCAR) (TURNCAR) ))
    (SETQ SHEARDU (GENSYM))
    (MKARRAY SHEARDU (LIST 4 4))
    (OR CHECK (PROGN
        (OR MEM (PROGN (MESSAGE (QUOTE "SHEAR = 0") T)
                       (TURNCAR) (TURNCAR) (TURNCAR) ))
        (MAPC LIND (FUNCTION (LAMBDA (A) (PROG2
            (RPLACA LAB A)
            (MAPC LIND (FUNCTION (LAMBDA (B) (PROGN
                (RPLACA (CDR LAB) B)
                (PUTIN SHEARDD LAB 0)
                (PUTIN SHEARDU LAB 0) )))) ))))
        (SETQ SHEAR 0)
        (RETURN CHECK)))
    (AND (EQ STOP (QUOTE SHEARDD)) (RETURN CHECK))
    (MAPC (CDR LIND) (FUNCTION (LAMBDA (A) (PROGN
        (RPLACA LAB A)
        (RPLACA (CDR LIJ) A)
        (MAPC LIND (FUNCTION (LAMBDA (B) (AND (GREATERP A B) (PROGN
            (RPLACA (CDR LAB) B)
            (RPLACA LIJ B)
            (PUTIN SHEARDD LAB (PICKEL SHEARDD LIJ)) )) ))) ))))
    (TIMEMESSAGE (QUOTE SHEARDD) T)
    (OR MEM (PROGN (TURNCAR) (TURNCAR) (TURNCAR) ))
    (SETQ MEM (MEMQ (QUOTE SHEARDU) NOPRINT))
    (SETQ LKC (LIST NIL NIL))
    (MAPC LIND (FUNCTION (LAMBDA (A) (PROGN
        (RPLACA LAB A)
        (RPLACA LIJ A)
        (MAPC LIND (FUNCTION (LAMBDA (B) (PROG(V)
            (RPLACA (CDR LAB) B)
            (RPLACA (CDR LKC) B)
            (MAPC LIND (FUNCTION (LAMBDA (R) (PROGN
                (RPLACA (CDR LIJ) R)
                (RPLACA LKC R)
                (SETQ V (CONS (STIMES (LIST (PICKEL INVMETRIC LKC)
                                   (PICKEL SHEARDD LIJ))) V)) ))))
            (SETQ V (SPLUS V))
            (SUBSALL (QUOTE V) (QUOTE SHEARDU) NIL LAB SIMPLSUBS)
            (PUTIN SHEARDU LAB V)
            (OR (EQN V 0) MEM (PROG2
                (INPRINT (QUOTE SHEARDU) (QUOTE (- +)) LAB (QUOTE =) V)
                (TURNCAR))) )))) ))))
    (TIMEMESSAGE (QUOTE SHEARDU) NIL)
    (OR MEM (PROGN (TURNCAR) (TURNCAR) (TURNCAR) ))
    (AND (EQ STOP (QUOTE SHEARDU)) (RETUNRN CHECK))
    (AND (MEMQ (QUOTE RAYCHAUDHURI) NOPRINT) (MEMQ (QUOTE SHEAR)NOPRINT)
         (MEMQ (QUOTE SHEAREVOL) NOPRINT) (RETURN CHECK))
    (SETQ W NIL)
    (MAPC LIND (FUNCTION (LAMBDA (A) (PROGN
        (RPLACA LAB A)
        (RPLACA (CDR LIJ) A)
        (MAPC LIND (FUNCTION (LAMBDA (B) (PROGN
            (RPLACA (CDR LAB) B)
            (RPLACA LIJ B)
            (SETQ W (CONS (STIMES (LIST (QUOTE (1 . 2))
                (PICKEL SHEARDU LAB) (PICKEL SHEARDU LIJ)))W)) )))) ))))
    (SETQ W (SPLUS W))
    (SUBSALL (QUOTE W) (QUOTE SHEAR) NIL NIL SIMPLSUBS)
    (SETQ SHEAR W)
    (SETQ W NIL)
    (SETQ MEM (MEMQ (QUOTE SHEAR) NOPRINT))
    (OR MEM (PROGN
        (INPRINT (QUOTE "SHEAR SQUARED") NIL NIL (QUOTE =) SHEAR)
        (TURNCAR) (TURNCAR) (TURNCAR)))
    (TIMEMESSAGE (QUOTE "SHEAR SCALAR") NIL)
    (OR MEM (PROGN (TURNCAR) (TURNCAR) (TURNCAR) ))
    (RETURN CHECK)  ))
(de MAKEROTCONS ( ) (PROG (CHECK MEM W)
    (SETQ MEM (MEMQ (QUOTE ROTCONS) NOPRINT))
    (SETQ LKC (LIST NIL NIL))
    (MAPC LIND (FUNCTION (LAMBDA (A) (OR (GREATERP A 1) (PROGN
        (RPLACA LAB A)
        (RPLACA (CDR LIJ) A)
        (MAPC (CDR (MEMBER A LIND)) (FUNCTION (LAMBDA (B)
              (OR (GREATERP B 2) (PROGN
            (RPLACA (CDR LAB) B)
            (RPLACA LKC B)
            (MAPC (CDR (MEMBER B LIND)) (FUNCTION (LAMBDA (C)
                (PROG (VA VB VC LA LB LC PA PB PC)
                (RPLACA LIJ C)
                (RPLACA (CDR LKC) C)
                (SETQ W (SPLUS (LIST
                    (STIMES (LIST (QUOTE (1 . 3))
                        (DERIV (SETQ VC (NTH COORD (ADD1 C)))
                               (PICKEL ROTDD LAB)) ))
                    (STIMES (LIST (QUOTE (1 . 3))
                        (DERIV (SETQ VB (NTH COORD (ADD1 B)))
                               (PICKEL ROTDD LIJ)) ))
                    (STIMES (LIST (QUOTE (1 . 3))
                        (DERIV (SETQ VA (NTH COORD (ADD1 A)))
                               (PICKEL ROTDD LKC)) )) )))
                (SETQ LB (PICKEL LVELO (LIST B)))
                (SETQ PA (PICKEL LACCE (LIST A)))
                (SETQ LC (PICKEL LVELO (LIST C)))
                (SETQ LA (PICKEL LVELO (LIST A)))
                (SETQ PC (PICKEL LACCE (LIST C)))
                (SETQ PB (PICKEL LACCE (LIST B)))
                (SETQ W (SPLUS (LIST W
                    (STIMES (LIST (QUOTE (1 . 6)) LB (DERIV VC PA)))
                    (STIMES (LIST (QUOTE (-1 . 6)) LC (DERIV VB PA)))
                    (STIMES (LIST (QUOTE (1 . 6)) LA (DERIV VB PC)))
                    (STIMES (LIST (QUOTE (-1 . 6)) LB (DERIV VA PC)))
                    (STIMES (LIST (QUOTE (1 . 6)) LC (DERIV VA PB)))
                    (STIMES (LIST (QUOTE (-1 . 6)) LA(DERIV VC PB))) )))
                (SETQ W (SPLUS (LIST W
                    (STIMES (LIST (QUOTE (1 . 3)) PA(PICKEL ROTDD LKC)))
                    (STIMES (LIST (QUOTE (1 . 3)) PB(PICKEL ROTDD LIJ)))
                    (STIMES (LIST (QUOTE (1 . 3)) PC
                                  (PICKEL ROTDD LAB))) )))
                (SUBSALL (QUOTE W) (QUOTE ROTCONS) NIL
                         (SETQ LA (LIST A B C)) SIMPLSUBS)
                (OR (EQN W 0) (PROG2
                    (SETQ CHECK T)
                    (OR MEM (PROG2
                        (INPRINT (QUOTE ROTCONS) NIL LA (QUOTE =) W)
                        (TURNCAR))) ))   )))) )) ))) )) )))
    (OR CHECK MEM (MESSAGE (LIST (QUOTE "ALL THE ROTATION CONSTRAINTS")
         (QUOTE "ARE FULFILLED IDENTICALLY")) T))
    (TIMEMESSAGE (QUOTE "ROTATION CONSTRAINTS") NIL)
    (OR MEM (PROGN (TURNCAR) (TURNCAR) (TURNCAR) ))
    (RETURN CHECK)  ))
(de MAKESHEARCONS ( ) (PROG (CHECK MEM V1 V2 V3 V4)
    (SETQ MEM (MEMQ (QUOTE SHEARCONS) NOPRINT))
    (SETQ LKC (LIST NIL NIL))
    (SETQ V1 (LIST NIL NIL))
    (SETQ V3 (COPY (SETQ V2 (COPY V1))))
    (SETQ V4 (COPY V1))
    (MAPC LIND (FUNCTION (LAMBDA (A) (PROG (V L)
        (RPLACA LAB A)
        (MAPC LIND (FUNCTION (LAMBDA (B) (PROG (W VB VC PBC DE)
            (SETQ VB (NTH COORD (ADD1 B)))
            (RPLACA (CDR LAB) B)
            (RPLACA LIJ B)
            (RPLACA V2 B)
            (RPLACA (CDR V3) B)
            (MAPC LIND (FUNCTION (LAMBDA (C) (PROGN
                (RPLACA (CDR LIJ) C)
                (RPLACA (CDR V1) C)
                (RPLACA V3 C)
                (RPLACA V4 C)
                (SETQ VC (NTH COORD (ADD1 C)))
                (SETQ W (CONS (DERIV VC (SETQ PBC(PICKEL ROTDU LIJ)))W))
                (SETQ W (CONS (STIMES (LIST
                    (SETQ DE (DERIV VC DETEM)) (SEXPT DETEM -1) PBC))W))
                (SETQ W (CONS
                    (SMINUS (DERIV VC(SETQ PBC(PICKEL SHEARDU LIJ))))W))
                (SETQ W (CONS
                    (STIMES (LIST -1 DE (SEXPT DETEM -1) PBC)) W))
                (MAPC LIND (FUNCTION (LAMBDA (R) (PROGN
                    (RPLACA LKC R)
                    (RPLACA V1 R)
                    (MAPC LIND (FUNCTION (LAMBDA (M) (PROGN
                        (RPLACA (CDR LKC) M)
                        (RPLACA (CDR V2) M)
                        (RPLACA (CDR V4) M)
                        (SETQ W (CONS (STIMES (LIST
                            (PICKEL INVMETRIC LKC)
                            (SPLUS (LIST
                                (STIMES (LIST -1 (PICKEL ROTDU V1)
                                    (DERIV VC (PICKEL METRIC V2)) ))
                                (STIMES (LIST (QUOTE (1 . 2))
                                    (PICKEL SHEARDU V1)
                                    (DERIV VB (PICKEL METRIC V4)) ))
                                      )) )) W))      )))) )))) ))))
            (SETQ W (SPLUS W))
            (SETQ W (SPLUS (LIST W (STIMES (LIST (QUOTE (2 . 3))
                                                 (DERIV VB EXPA) )) )))
            (SETQ W (STIMES (LIST W (PICKEL PROJDU LAB) )))
            (SETQ PBC (PICKEL UACCE (LIST B)))
            (SETQ W (SPLUS (LIST W
                  (STIMES (LIST -1 (PICKEL ROTDD LAB) PBC))
                  (STIMES (LIST -1 (PICKEL SHEARDD LAB) PBC)) )))
            (SETQ V (CONS W V)) ))))
        (SETQ V (SPLUS V))
        (SUBSALL (QUOTE V) (QUOTE SHEARCONS) NIL (LIST A) SIMPLSUBS)
        (OR (EQN V 0) (PROG2
            (SETQ CHECK T)
            (OR MEM (PROG2
                (INPRINT (QUOTE SHEARCONS) NIL (LIST A) (QUOTE =) V)
                (TURNCAR))) )) ))))
    (OR CHECK MEM (MESSAGE (LIST (QUOTE "ALL THE SHEAR CONSTRAINTS")
         (QUOTE "ARE FULFILLED IDENTICALLY")) T))
    (TIMEMESSAGE (QUOTE "SHEAR CONSTRAINTS") NIL)
    (OR MEM (PROGN (TURNCAR) (TURNCAR) (TURNCAR) ))
    (RETURN CHECK)  ))
(de MAKEROTEVOL ( ) (PROG (CHECK V1 V2)
    (SETQ LKC (LIST NIL NIL))
    (SETQ V2 (COPY (SETQ V1 (COPY LKC))))
    (MAPC LIND (FUNCTION (LAMBDA (A) (OR (EQN A 3) (PROGN
        (RPLACA LAB A)
        (RPLACA LIJ A)
        (MAPC (CDR (MEMBER A LIND)) (FUNCTION (LAMBDA (B) (PROG (W)
            (RPLACA (CDR LAB) B)
            (RPLACA LKC B)
            (RPLACA V2 B)
            (MAPC LIND (FUNCTION (LAMBDA (C) (PROGN
                (RPLACA (CDR LIJ) C)
                (RPLACA V1 C)
                (RPLACA (CDR V2) C)
                (RPLACA (CDR LABC) C)
                (RPLACA LIJK C)
                (MAPC LIND (FUNCTION (LAMBDA (D) (PROGN
                    (RPLACA (CDR LKC) D)
                    (RPLACA (CDR V1) D)
                    (RPLACA LABC D)
                    (RPLACA (CDR LIJK) D)
                    (MAPC LIND (FUNCTION (LAMBDA (R) (PROG (UR)
                        (SETQ UR (PICKEL UVELO (LIST R)))
                        (RPLACA (CDDR LABC) R)
                        (RPLACA (CDDR LIJK) R)
                        (SETQ W (CONS (STIMES (LIST
                            (PICKEL PROJDU LIJ) (PICKEL PROJDU LKC) UR
                            (DERIV (NTH COORD (ADD1 R))
                                   (PICKEL ROTDD V1)) )) W))
                        (SETQ W (CONS (STIMES (LIST
                            (PICKEL CHRIS LABC) (PICKEL PROJDU LIJ)
                            (PICKEL ROTDD LKC) UR)) W))
                        (SETQ W (CONS (STIMES (LIST -1
                            (PICKEL CHRIS LIJK) (PICKEL PROJDU LKC)
                            (PICKEL ROTDD LIJ) UR)) W)) ))))
                    (SETQ W (CONS (STIMES (LIST (QUOTE (1 . 2))
                          (PICKEL PROJDU LIJ) (PICKEL PROJDU LKC)
                          (SPLUS (LIST
                             (SMINUS (DERIV (NTH COORD (ADD1 D))
                                            (PICKEL LACCE (LIST C))))
                             (DERIV (NTH COORD (ADD1 C))
                                    (PICKEL LACCE (LIST D))) )) ))
                                                         W)) )))) ))))
            (SETQ W (CONS (SPLUS W) NIL))
            (MAPC LIND (FUNCTION (LAMBDA (C) (PROGN
                (RPLACA (CDR LIJ) C)
                (RPLACA (CDR V2) C)
                (SETQ W (CONS (STIMES (LIST -1 (PICKEL SHEARDD LIJ)
                                            (PICKEL ROTDU V2))) W))
                (SETQ W (CONS (STIMES (LIST (PICKEL SHEARDD V2)
                                           (PICKEL ROTDU LIJ))) W)) ))))
            (SETQ W (SPLUS (CONS (STIMES (LIST (QUOTE (2 . 3)) EXPA
                                         (PICKEL ROTDD LAB))) W)))
            (SUBSALL (QUOTE W) (QUOTE ROTEVOL) NIL LAB SIMPLSUBS)
            (OR (EQN W 0) (PROGN
                (SETQ CHECK T)
                (INPRINT (QUOTE ROTEVOL) NIL LAB (QUOTE =) W)
                (TURNCAR))) )))) )) )))
    (OR CHECK (MESSAGE (LIST (QUOTE "ALL THE ROTATION EVOLUTION")
         (QUOTE "EQUATIONS ARE FULFILLED IDENTICALLY")) T))
    (TIMEMESSAGE (QUOTE "ROTATION EVOLUTION EQUATIONS") NIL)
    (TURNCAR) (TURNCAR) (TURNCAR)
    (RETURN CHECK)  ))
(de MAKERAYCH ( ) (PROG (W MEM UJ UR)
    (SETQ MEM (MEMQ (QUOTE RAYCHAUDHURI) NOPRINT))
    (MAPC LIND (FUNCTION (LAMBDA (A)
        (SETQ W (CONS (STIMES (LIST (DERIV (NTH COORD (ADD1 A)) EXPA)
                              (PICKEL UVELO (LIST A)) )) W)) )))
    (SETQ W (CONS (SPLUS (CONS (STIMES (LIST (QUOTE (1 . 3))
                                       (SEXPT EXPA 2))) W)) NIL))
    (MAPC LIND (FUNCTION (LAMBDA (A) (PROG2
        (RPLACA LAB A)
        (MAPC LIND (FUNCTION (LAMBDA (B) (PROG2
            (RPLACA (CDR LAB) B)
            (SETQ W (CONS (STIMES (LIST -1 (PICKEL INVMETRIC LAB)
                                  (PICKEL ATIDA LAB))) W)) )))) ))))
    (SETQ W (SPLUS W))
    (SETQ W (SPLUS (LIST W (STIMES (LIST 2 SHEAR))
                         (STIMES (LIST -2 ROT)) )))
    (SETQ W (CONS W NIL))
    (MAPC LIND (FUNCTION (LAMBDA (I)
        (OR (EQN (SETQ UR (PICKEL VMATRIX (LIST I))) 0) (PROG2
        (RPLACA LIJ I)
        (MAPC (MEMBER I LIND) (FUNCTION (LAMBDA (J)
            (OR (EQN (SETQ UJ (PICKEL VMATRIX (LIST J))) 0) (PROG (V)
            (RPLACA (CDR LIJ) J)
            (SETQ V (LIST (PICKEL RC LIJ) UR UJ))
            (OR (EQN I J) (SETQ V (CONS 2 V)))
            (SETQ V (STIMES V))
            (OR (EQN V 0) (SETQ W (CONS V W))) )) ))) )) )))
    (SETQ W (SPLUS W))
    (SUBSALL (QUOTE W) (QUOTE RAYCHAUDHURI) NIL NIL SIMPLSUBS)
    (OR MEM (PROG2
        (INPRINT (QUOTE "RAYCHAUDHURI EQUATION") NIL NIL (QUOTE =) W)
        (TURNCAR) ))
    (TIMEMESSAGE (QUOTE "RAYCHAUDHURI EQUATION") NIL)
    (TURNCAR) (TURNCAR) (TURNCAR)
    (RETURN W) ))
(de MAKELWEYL ( ) (PROG (CHECK MEM)
    (SETQ MEM (MEMQ (QUOTE ELWEYL) NOPRINT))
    (SETQ LKC (LIST NIL NIL))
    (SETQ ELWEYL (GENSYM))
    (MKARRAY ELWEYL (LIST 4 4))
    (MAPC LIND (FUNCTION (LAMBDA (A) (PROGN
        (RPLACA LAB A)
        (RPLACA (CDR LIJ) A)
        (MAPC (MEMBER A LIND) (FUNCTION (LAMBDA (B)
            (PROG (V V1 V2 VUJ VUL W)
            (RPLACA (CDR LAB) B)
            (RPLACA (CDR LKC) B)
            (MAPC LIND (FUNCTION (LAMBDA (I) (PROGN
                (RPLACA LIJKL I)
                (RPLACA LIJ I)
                (OR (EQN (SETQ V1 (PICKEL EMATRIX LIJ)) 0)
                         (MAPC LIND (FUNCTION (LAMBDA (J) (PROG2
                    (RPLACA (CDR LIJKL) J)
                    (OR (EQN (SETQ VUJ (PICKEL VMATRIX (LIST J))) 0)
                             (MAPC LIND (FUNCTION (LAMBDA (K) (PROGN
                        (RPLACA (CDDR LIJKL) K)
                        (RPLACA LKC K)
                        (OR (EQN (SETQ V2 (PICKEL EMATRIX LKC)) 0)
                                 (MAPC LIND (FUNCTION (LAMBDA (L) (PROG2
                            (RPLACA (CDDDR LIJKL) L)
                            (OR (EQN (SETQ VUL (PICKEL VMATRIX(LIST L)))
                                     0) (PROG2
                                (SETQ W (STIMES (LIST
                                     (PICKEL RM LIJKL) V1 VUJ V2 VUL)))
                                (OR (EQN W 0) (SETQ V (CONS W V)))
                           )) )))) )) ))) )) ))) )) )))
            (SETQ V (COND (V   (SPLUS V))
                          (T   0)))
            (SUBSALL (QUOTE V) (QUOTE ELWEYL) NIL LAB SIMPLSUBS)
            (PUTIN ELWEYL LAB V)
            (OR (EQN V 0) (PROG2
                (SETQ CHECK T)
                (OR MEM (PROG2
                    (INPRINT (QUOTE ELWEYL) NIL LAB (QUOTE =) V)
                    (TURNCAR))) )) )))) ))))
    (OR CHECK MEM (MESSAGE (LIST (QUOTE "THE ELECTRIC PART OF")
         (QUOTE "THE WEYL TENSOR IS ZERO")) T))
    (TIMEMESSAGE (QUOTE ELWEYL) NIL)
    (OR MEM (PROGN (TURNCAR) (TURNCAR) (TURNCAR) ))
    (RETURN CHECK)  ))
(de MAKESHEAREVOL ( ) (PROG (CHECK V1 V2 V3)
    (SETQ V3 (COPY (SETQ V2 (COPY (SETQ V1 (LIST NIL NIL)) )) ))
    (SETQ LKC (COPY V1))
    (MAPC LIND (FUNCTION (LAMBDA (A) (PROGN
        (RPLACA LAB A)
        (RPLACA LIJ A)
        (MAPC (MEMBER A LIND) (FUNCTION (LAMBDA (B) (PROG (W)
            (RPLACA (CDR LAB) B)
            (RPLACA LKC B)
            (RPLACA V3 B)
            (MAPC LIND (FUNCTION (LAMBDA (C) (PROGN
                (RPLACA (CDR LIJ) C)
                (RPLACA V1 C)
                (RPLACA (CDR V2) C)
                (RPLACA (CDR V3) C)
                (RPLACA (CDR LABC) C)
                (RPLACA LIJK C)
                (MAPC LIND (FUNCTION (LAMBDA (D) (PROGN
                    (RPLACA (CDR LKC) D)
                    (RPLACA (CDR V1) D)
                    (RPLACA V2 D)
                    (RPLACA LABC D)
                    (RPLACA (CDR LIJK) D)
                    (MAPC LIND (FUNCTION (LAMBDA (R) (PROG (UR)
                        (SETQ UR (PICKEL UVELO (LIST R)))
                        (RPLACA (CDDR LABC) R)
                        (RPLACA (CDDR LIJK) R)
                        (SETQ W (CONS (STIMES (LIST
                            (PICKEL PROJDU LIJ) (PICKEL PROJDU LKC) UR
                            (DERIV (NTH COORD (ADD1 R))
                                   (PICKEL SHEARDD V1)) )) W))
                        (SETQ W (CONS (STIMES (LIST -1
                            (PICKEL CHRIS LABC) (PICKEL PROJDU LIJ)
                            (PICKEL SHEARDD LKC) UR)) W))
                        (SETQ W (CONS (STIMES (LIST -1
                            (PICKEL CHRIS LIJK) (PICKEL PROJDU LKC)
                            (PICKEL SHEARDD LIJ) UR)) W)) ))))
                    (SETQ W (CONS (STIMES (LIST (QUOTE (-1 . 2))
                          (PICKEL PROJDU LIJ) (PICKEL PROJDU LKC)
                          (SPLUS (LIST (PICKEL ATIDA V1)
                         (PICKEL ATIDA V2))) )) W))
                    (SETQ W (CONS (STIMES (LIST (QUOTE (1 . 3))
                          (PICKEL PROJDD LAB) (PICKEL INVMETRIC V1)
                          (PICKEL ATIDA V1))) W)) ))))
                (SETQ W (CONS (STIMES (LIST -1 (PICKEL ROTDD LIJ)
                                            (PICKEL ROTDU V3))) W))
                (SETQ W (CONS (STIMES (LIST (PICKEL SHEARDD LIJ)
                                      (PICKEL SHEARDU V3))) W)) ))))
            (SETQ W (SPLUS W))
            (SETQ W (SPLUS (LIST W
                 (STIMES (LIST (PICKEL LACCE (LIST A))
                               (PICKEL LACCE (LIST B)) ))
                 (STIMES (LIST (QUOTE (2 . 3)) EXPA
                               (PICKEL SHEARDD LAB)))
                 (STIMES (LIST (QUOTE (2 . 3)) (PICKEL PROJDD LAB)
                         (SPLUS (LIST ROT (SMINUS SHEAR))) ))
                 (PICKEL ELWEYL LAB) )))
            (SUBSALL (QUOTE W) (QUOTE SHEAREVOL) NIL LAB SIMPLSUBS)
            (OR (EQN W 0) (PROGN
                (SETQ CHECK T)
                (INPRINT (QUOTE SHEAREVOL) NIL LAB (QUOTE =) W)
                (TURNCAR))) )))) ))))
    (OR CHECK (MESSAGE (LIST (QUOTE "ALL THE SHEAR EVOLUTION")
         (QUOTE "EQUATIONS ARE FULFILLED IDENTICALLY")) T))
    (TIMEMESSAGE (QUOTE "SHEAR EVOLUTION EQUATIONS") NIL)
    (TURNCAR) (TURNCAR) (TURNCAR)
    (RETURN CHECK)  ))
(de SIGNPER (LIS) (PROG (I J K L V1 V2 V3 SIG)
    (SETQ I (CAR LIS))
    (SETQ J (CADR LIS))
    (SETQ K (CADDR LIS))
    (SETQ L (CADDDR LIS))
    (AND (OR (EQN I J) (EQN I K) (EQN I L) (EQN J K) (EQN J L)(EQN K L))
         (RETURN 0))
    (SETQ SIG 1)
    (AND (GREATERP I J) (PROGN (SETQ V1 I)
                               (SETQ I J)
                               (SETQ J V1)
                               (SETQ SIG (MINUS SIG)) ))
    (AND (GREATERP I K) (PROGN (SETQ V1 I)
                               (SETQ V2 J)
                               (SETQ I K)
                               (SETQ J V1)
                               (SETQ K V2) ))
    (AND (GREATERP I L) (PROGN (SETQ V1 I)
                               (SETQ V2 J)
                               (SETQ V3 K)
                               (SETQ I L)
                               (SETQ J V1)
                               (SETQ K V2)
                               (SETQ L V3)
                               (SETQ SIG (MINUS SIG)) ))
    (AND (GREATERP J K) (PROGN (SETQ V1 J)
                               (SETQ J K)
                               (SETQ K V1)
                               (SETQ SIG (MINUS SIG)) ))
    (AND (GREATERP J L) (PROGN (SETQ V1 J)
                               (SETQ V2 K)
                               (SETQ J L)
                               (SETQ K V1)
                               (SETQ L V2) ))
    (AND (GREATERP K L) (SETQ SIG (MINUS SIG)) )
    (RETURN SIG) ))
(de MAKEMAGWEYL ( ) (PROG (CHECK MEM)
    (SETQ MEM (MEMQ (QUOTE MAGWEYL) NOPRINT))
    (SETQ LKC (LIST NIL NIL))
    (SETQ MAGWEYL (GENSYM))
    (MKARRAY MAGWEYL (LIST 4 4))
    (MAPC LIND (FUNCTION (LAMBDA (A) (PROGN
        (RPLACA LAB A)
        (RPLACA (CDR LIJ) A)
        (MAPC (MEMBER A LIND) (FUNCTION (LAMBDA (B)
            (PROG (V V1 V2 UJ UM W)
            (RPLACA (CDR LAB) B)
            (RPLACA (CDR LKC) B)
            (MAPC LIND (FUNCTION (LAMBDA (I) (PROGN
                (RPLACA LIJKL I)
                (RPLACA LIJ I)
                (OR (EQN (SETQ V1 (PICKEL EMATRIX LIJ)) 0)
                         (MAPC LIND (FUNCTION (LAMBDA (J) (PROG2
                    (RPLACA (CDR LIJKL) J)
                    (OR (EQN (SETQ UJ (PICKEL VMATRIX (LIST J))) 0)
                             (MAPC LIND (FUNCTION (LAMBDA (N) (PROGN
                        (RPLACA (CDDR LABCD) N)
                        (RPLACA LKC N)
                        (OR (EQN (SETQ V2 (PICKEL EMATRIX LKC)) 0)
                                 (MAPC LIND (FUNCTION (LAMBDA (M) (PROG2
                            (RPLACA (CDDDR LABCD) M)
                            (OR (EQN (SETQ UM (PICKEL VMATRIX (LIST M)))
                                     0) (MAPC LIND (FUNCTION (LAMBDA (K)
                                (PROGN
                                (RPLACA (CDDR LIJKL) K)
                                (RPLACA LABCD K)
                                (MAPC LIND (FUNCTION (LAMBDA (L) (PROGN
                                    (RPLACA (CDDDR LIJKL) L)
                                    (RPLACA (CDR LABCD) L)
                                    (SETQ W (STIMES (LIST (QUOTE(1 . 2))
                                          (SIGNPER LIJKL) V1 UJ V2 UM
                                          (PICKEL RM LABCD))))
                                    (AND (OR (EQN K 0) (EQN L 0))
                                         (SETQ W (SMINUS W)))
                                    (OR (EQN W 0) (SETQ V (CONS W V)))
                           )))) )))) )) ))) )) ))) )) ))) )) )))
            (SETQ V (COND (V   (SPLUS V))
                          (T   0)))
            (SUBSALL (QUOTE V) (QUOTE MAGWEYL) NIL LAB SIMPLSUBS)
            (PUTIN MAGWEYL LAB V)
            (OR (EQN V 0) (PROG2
                (SETQ CHECK T)
                (OR MEM (PROG2
                    (INPRINT (QUOTE MAGWEYL) NIL LAB (QUOTE =) V)
                    (TURNCAR))) )) )))) ))))
    (OR CHECK MEM (MESSAGE (LIST (QUOTE "THE MAGNETIC PART OF")
         (QUOTE "THE WEYL TENSOR IS ZERO")) T))
    (TIMEMESSAGE (QUOTE MAGWEYL) NIL)
    (OR MEM (PROGN (TURNCAR) (TURNCAR) (TURNCAR) ))
    (RETURN CHECK)  ))
(de MAKEMAGCONS ( ) (PROG (CHECK V1 V2 V3 V4 UR LA LB UM VN SP RS)
    (SETQ V2 (COPY (SETQ V1 (COPY (SETQ LKC (LIST NIL NIL)) )) ))
    (SETQ V4 (COPY (SETQ V3 (LIST NIL NIL)) ))
    (MAPC LIND (FUNCTION (LAMBDA (A) (PROGN
        (SETQ LA (LIST A))
        (RPLACA V1 A)
        (RPLACA (CDR V3) A)
        (RPLACA (CDR LABC) A)
        (RPLACA LAB A)
        (MAPC (MEMBER A LIND) (FUNCTION (LAMBDA (B) (PROG (V)
            (SETQ LB (LIST B))
            (RPLACA LKC B)
            (RPLACA (CDR V4) B)
            (RPLACA (CDR LIJK) B)
            (RPLACA (CDR LAB) B)
            (MAPC LIND (FUNCTION (LAMBDA (R)
                   (OR (EQN (SETQ UR (PICKEL LVELO (LIST R))) 0) (PROG2
                (RPLACA (CDR LIJKL) R)
                (MAPC LIND (FUNCTION (LAMBDA (M) (PROGN
                    (SETQ UM (PICKEL LVELO (LIST M)))
                    (RPLACA (CDDR LIJKL) M)
                    (RPLACA LIJ M)
                    (RPLACA V3 M)
                    (RPLACA V2 M)
                    (RPLACA V4 M)
                    (MAPC LIND (FUNCTION (LAMBDA (N) (PROGN
                        (SETQ VN (NTH COORD (ADD1 N)))
                        (RPLACA (CDDDR LIJKL) N)
                        (RPLACA (CDR LIJ) N)
                        (RPLACA (CDDR LABC) N)
                        (RPLACA (CDDR LIJK) N)
                        (MAPC LIND (FUNCTION (LAMBDA (D) (PROG2
                            (RPLACA LIJKL D)
                            (OR (EQN (SETQ SP (SIGNPER LIJKL))0)(PROG(L)
                                (RPLACA (CDR LKC) D)
                                (RPLACA (CDR V1) D)
                                (MAPC LIND (FUNCTION (LAMBDA (S)(PROG(W)
                                    (RPLACA LABC S)
                                    (RPLACA LIJK S)
                                    (RPLACA (CDR V2) S)
                                    (SETQ W (CONS (STIMES (LIST SP UR
                                       (QUOTE (1 . 2)) (SEXPT DETEM -1)
                                       (SPLUS (LIST (PICKEL ROTDD V2)
                                          (SMINUS (PICKEL SHEARDD V2))))
                                       (SPLUS (LIST
                                           (STIMES (LIST
                                              (PICKEL CHRIS LABC)
                                              (PICKEL METRIC LKC) ))
                                           (STIMES (LIST
                                              (PICKEL CHRIS LIJK)
                                              (PICKEL METRIC V1))) ))
                                         )) W))
                                    (SETQ W (SPLUS W))
                                    (OR (EQN W 0) (SETQ L (CONS W L)))
                                       ))))
                                (SETQ L (CONS (STIMES (LIST SP UR
                                    (QUOTE (1 . 2)) (SEXPT DETEM -1)
                                    (SPLUS (LIST
                                       (STIMES (LIST (DERIV VN UM)
                                          (SPLUS (LIST
                                             (STIMES (LIST
                                                (PICKEL METRIC LKC)
                                                (SPLUS (LIST
                                                   (PICKEL LACCE LA)
                                                   (STIMES (LIST EXPA
                                                      (QUOTE(-1 . 3))
                                                      (PICKEL LVELO LA)))
                                                  )) ))
                                             (STIMES (LIST
                                                (PICKEL METRIC V1)
                                                (SPLUS (LIST
                                                   (PICKEL LACCE LB)
                                                   (STIMES (LIST EXPA
                                                      (QUOTE(-1 . 3))
                                                      (PICKEL LVELO LB)))
                                              )) )) )) ))
                                       (STIMES (LIST (DERIV VN
                                           (SPLUS (LIST
                                             (SMINUS (PICKEL ROTDD V3))
                                             (PICKEL SHEARDD V3) )) )
                                          (PICKEL METRIC LKC) ))
                                       (STIMES (LIST (DERIV VN
                                           (SPLUS (LIST
                                             (SMINUS (PICKEL ROTDD V4))
                                             (PICKEL SHEARDD V4) )) )
                                          (PICKEL METRIC V1) ))
                                                           )) )) L))
                                (SETQ L (SPLUS L))
                                (SETQ V (CONS L V))
                                    )) )))) )))) )))) )) )))
            (SETQ V (COND (V   (SPLUS V))
                          (T   0)))
            (SETQ V (SPLUS (LIST V (SMINUS (PICKEL MAGWEYL LAB)) )))
            (SUBSALL (QUOTE V) (QUOTE MAGCONS) NIL LAB SIMPLSUBS)
            (OR (EQN V 0) (PROGN
                (SETQ CHECK T)
                (INPRINT (QUOTE MAGCONS) NIL LAB (QUOTE =) V)
                (TURNCAR))) )))) ))))
    (OR CHECK (MESSAGE (LIST (QUOTE "ALL THE MAGNETIC CONSTRAINTS")
         (QUOTE "ARE FULFILLED IDENTICALLY")) T))
    (TIMEMESSAGE (QUOTE MAGCONS) NIL)
    (TURNCAR) (TURNCAR) (TURNCAR)
    (RETURN CHECK)  ))

(de ELLISINIT (L NUMBER) (PROG (V V1 ARRAY MEM GLS)
    (TERPRI) (TERPRI)
    (PRINTC (CAR L))
    (TERPRI) (TERPRI)
    (MAPC (CDR L) (FUNCTION (LAMBDA (LE) (SELECT (CAR LE)
        ((QUOTE COORDINATES)   (SETQ COORD (CDR LE)))
        ((QUOTE FUNCTIONS)   (SETQ FUNCTIONS (CDR LE)))
        ((QUOTE CONSTANTS)   (SETQ CONSTANTS (CDR LE)))
        ((QUOTE EMATRIX)   (SETQ ARRAY (CDR LE)))
        ((QUOTE SYMBOLS)   (SETQ METSUBS (CDR LE)))
        ((QUOTE SUBSTITUTIONS)   (SETQ SIMPLSUBS (CDR LE)))
        ((QUOTE DONT)   (SETQ NOPRINT (CDDR LE)))
        ((QUOTE STOP)   (SETQ STOP (CADDR LE)))
        ((QUOTE TENSORS)   (SETQ TENSORS (CDR LE)))
        ((QUOTE DATA)   (SETQ DATASUBS (CDDR LE)))
        ((QUOTE EXPAND)   (PROG2 (SETQ LPOWER (CADDDR LE))
                                 (SETQ UPOWER (CADR (CDDDDR LE))) ))
        ((QUOTE MARKERS)   (SETQ MARKERS (CDR LE)))
        ((QUOTE RMARGIN)   (SETQ RMARGIN (CADR LE)))
        ((QUOTE LMARGIN)   (SETQ LMARGIN (CADR LE)))
        ((QUOTE VELOCITY)   (SETQ VELO (CDR LE)))
        ((QUOTE OUTPUT)   (COND
           ((EQUAL LE (QUOTE (OUTPUT FOR INPUT)))
                                            (SETQ OUTINP (QUOTE INPUT)))
           ((EQUAL LE (QUOTE (OUTPUT FOR LATEX)))
                                            (SETQ OUTINP (QUOTE LATEX)))
           (T          (ERROR (LIST (QUOTE "*****///") LE (QUOTE "///*****")
                                    (QUOTE "IS AN ILLEGAL ARGUMENT")
                                    (QUOTE "FOR OUR SYSTEM.")
                                    (QUOTE "SORRY, CAN'T GO ON."))) )))
        (ERROR (LIST (QUOTE "*****///") LE (QUOTE "///*****")
                          (QUOTE "IS AN ILLEGAL ARGUMENT")
                          (QUOTE "FOR OUR SYSTEM.")
                                    (QUOTE "SORRY, CAN'T GO ON")))) )))
    (OR (EQN (SETQ V (LENGTH ARRAY)) NUMBER)
        (ERROR (LIST (COND ((GREATERP V NUMBER)   (QUOTE "TOO MANY"))
                           (T   (QUOTE "TOO FEW")))
                     (QUOTE "ELEMENTS OF THE MATRIX.")
                     (QUOTE "CHEER UP BOY,")
                     (QUOTE "YOU CAN TRY ONCE MORE"))))
    (OR COORD (ERROR (LIST (QUOTE "YOU DID NOT SPECIFY THE NAMES OF")
                           (QUOTE "THE COORDINATES. I CANNOT DO MY")
                           (QUOTE "JOB WITHOUT THIS INFORMATION.")
                           (QUOTE "SORRY, TRY AGAIN PLEASE.")) ))
    (SETQ MESS (NOT (MEMQ (QUOTE MESSAGES) NOPRINT)))
    (OR LPOWER (SETQ LPOWER 2))
    (OR UPOWER (SETQ UPOWER 3))
    (AND (GREATERP RMARGIN 72) (LINELENGTH RMARGIN))
    (MAP METSUBS (FUNCTION (LAMBDA (ME)
                 (RPLACA ME (INTOPRE (CAR ME))) )))
    (LISTDEPS)
    (DEFSYMB)
    (MAKEPAIRS)
    (PUTSYMB)
    (MAP DATASUBS (FUNCTION (LAMBDA (DE)
         (RPLACA DE (SIMPLIFY (INTOPRE (CAR DE)) T)) )))
    (AND SYMBOLS (PROGN
         (MESSAGE (QUOTE SYMBOLS) T)
         (TURNCAR)
         (MAPC SYMBOLS (FUNCTION (LAMBDA (SE) (PROG2
               (INPRINT SE NIL NIL (QUOTE =) (GET SE (QUOTE CONTENT)))
               (TURNCAR)) ))) ))
    (MAPC MARKERS (FUNCTION (LAMBDA (ME) (SET ME NIL) )))
    (AND SIMPLSUBS (PROG (S M L DGLS M!?)
         (OR (SETQ MEM (MEMQ (QUOTE SUBSTITUTIONS) NOPRINT)) (PROG2
             (MESSAGE (QUOTE SUBSTITUTIONS) T)
             (TURNCAR)))
         (SETQ S (QUOTE =))
         (SETQ V SIMPLSUBS)
         (AND MARKERS (SETQ GLS
              (MAPCAR V (FUNCTION (LAMBDA (VE) (AND (EQ VE S) S) ))) )
              (SETQ DGLS GLS))
       A (OR (SETQ M (FRONT (SETQ L (PREVIOUS S V)) V)) MEM
             (MESSAGE (QUOTE EVERYWHERE) T))
         (SETQ V (MEMBER L V))
         (OR MEM (PROGN
             (MAPC M (FUNCTION (LAMBDA (ME) (PROG2
                (MESSAGE ME NIL)
                (MESSAGE BLANK NIL)) )))
             (TURNCAR) (TURNCAR) ))
         (RPLACA V (INTOPRE (CAR V)))
         (COND (M!?   (PROGN (SETQ DGLS (EQUATE V DGLS))
                            (RPLACA DGLS T)
                            (RPLACA V (SMOOTH (CAR V) T))
                            (SETQ M!? NIL)))
               (T   (RPLACA V (SIMPLIFY (CAR V) T))))
         (RPLACA (CDDR V) (SIMPLIFY (INTOPRE (CADDR V)) T))
         (SETQ M!? NIL)
         (AND (EQ (CADDR V) (QUOTE EXPAND)) (COND
              ((AND (NOT (ATOM (CAR V))) (EQ (CAAR V) (QUOTE EXPT))
                    (CDAR V) (CDDAR V) (NULL (CDDDAR V)))
                        (OR (AND DGLS (CAR DGLS)) (RPLACA (CDDR V)
                                      (DEVELOP (CADAR V) (CADDAR V))) ))
              (T   (ERROR (LIST (QUOTE "THE EXPRESSION *****///")
                      (CAR V) (QUOTE "///***** IS NOT AN EXPONENTIAL")
                      (QUOTE "EXPRESSION, AND SO THE COMMAND")
                      (QUOTE "** EXPAND ** IS MEANINGLESS IN THIS")
                      (QUOTE "CASE. SORRY, MUST QUIT."))) )))
         (OR MEM (PROGN
             (INPRINT (CAR V) NIL NIL S (CADDR V))
             (TURNCAR) (TURNCAR) ))
         (AND (SETQ V (CDDDR V)) (GO A)) ))
    (AND DATASUBS (PROG (GL)
         (PROG ( ) (MESSAGE (QUOTE (THE SUBSTITUTIONS LISTED ABOVE WILL
                            BE THEMSELVES TRANSFORMED BY THE FOLLOWING
                            SUBSTITUTIONS)) T)
                   (SETQ V DATASUBS)
                 A (COND ((EQ (CADR V) (QUOTE =))
                                         (MESSAGE (QUOTE EVERYWHERE) T))
                         (T   (MAPC (FRONT (PREVIOUS (QUOTE =) V) V)
                                    (FUNCTION (LAMBDA (FE) (PROG2
                                    (INPRINT (QUOTE "IN THE VALUE") NIL
                                       NIL (QUOTE "OF THE EXPRESSION")
                                       (CAR V))
                                    (SETQ V (CDR V))) ))) ))
                   (INPRINT (CAR V) NIL NIL (QUOTE =) (CADDR V))
                   (AND (SETQ V (CDDDR V)) (GO A)))
         (SETQ GL (MAPCAR SIMPLSUBS (FUNCTION (LAMBDA (SE)
                          (AND (EQ SE (QUOTE =)) SE) ))) )
         (CLEARDATA)
         (REMPROP (QUOTE CLEARDATA) (QUOTE EXPR))
         (REMPROP (QUOTE EQUATE) (QUOTE EXPR))
         (SETQ DATASUBS NIL)
         (OR (MEMQ (QUOTE MODIFICATIONS) NOPRINT) (PROGN
             (MESSAGE (QUOTE (THE SUBSTITUTIONS YOU ASKED ME TO
                 MODIFY WILL HAVE THE FOLLOWING FINAL FORM)) T)
             (TURNCAR) (TURNCAR) (TURNCAR)
             (PROG (S M L)
                 (SETQ S (QUOTE =))
                 (SETQ V SIMPLSUBS)
              A  (COND ((OR (PREVIOUS S GL) (NEXT S GL)) (PROGN
                            (OR (SETQ M (REMOVELAST (FRONT S V)))
                                (MESSAGE (QUOTE EVERYWHERE) T))
                            (MAPC M (FUNCTION (LAMBDA (ME) (PROGN
                                  (SETQ V (CDR V))
                                  (MESSAGE ME NIL)
                                  (MESSAGE BLANK NIL)) )))
                            (TURNCAR) (TURNCAR)
                            (INPRINT (CAR V) NIL NIL S (CADDR V))
                            (TURNCAR) (TURNCAR)
                            (AND (SETQ V (CDDDR V))
                                 (SETQ GL (CDDR (MEMQ S GL)))
                                 (GO A)) ))
                       (T   (AND (SETQ GL (CDDR (MEMQ S GL)))
                                 (SETQ V (CDDR (MEMQ S V)))
                                 (GO A))) ))) )))
    (SETQ SIMPLSUBS (SUBSTITUTIONS SIMPLSUBS))
    (LISTTENS TENSORS)
    (MAP ARRAY (FUNCTION (LAMBDA (AE)
                         (RPLACA AE (SIMPLIFY (INTOPRE (CAR AE)) T)) )))
    (MAP VELO (FUNCTION (LAMBDA (VE)
                         (RPLACA VE (SIMPLIFY (INTOPRE (CAR VE)) T)) )))
    (SETQ EMATRIX (GENSYM))
    (MKARRAY EMATRIX (LIST 4 4))
    (SETQ MEM (MEMQ (QUOTE EMATRIX) NOPRINT))
    (MAPC LIND (FUNCTION (LAMBDA (I) (PROG2
        (RPLACA LIJ I)
        (MAPC LIND (FUNCTION (LAMBDA (J) (PROGN
            (RPLACA (CDR LIJ) J)
            (SETQ V (CAR ARRAY))
            (SUBSALL (QUOTE V) (QUOTE EMATRIX) NIL LIJ SIMPLSUBS)
            (PUTIN EMATRIX LIJ V)
            (OR (EQN V 0) MEM (INPRINT (QUOTE EMATRIX) (QUOTE (+ -))
                         (RPLACD LIJ (CONS (CDR LIJ) NIL)) (QUOTE =) V))
            (SETQ ARRAY (CDR ARRAY))) ))) ))))
    (TIMEMESSAGE (QUOTE EMATRIX) T)
    (OR MEM (PROGN (TURNCAR) (TURNCAR) (TURNCAR) ))
    (REMPROP (QUOTE EMATRIX) (QUOTE SUBS))
    (SETQ VMATRIX (GENSYM))
    (MKARRAY VMATRIX (LIST 4))
    (SETQ MEM (MEMQ (QUOTE VELOCITY) NOPRINT))
    (MAPC LIND (FUNCTION (LAMBDA (I) (PROGN
        (SETQ V1 (CONS I NIL))
        (SETQ V (CAR VELO))
        (SUBSALL (QUOTE V) (QUOTE VELOCITY) NIL V1 SIMPLSUBS)
        (PUTIN VMATRIX V1 V)
        (OR (EQN V 0) MEM (PROG2
            (INPRINT (QUOTE VELOCITY) (QUOTE (+)) V1 (QUOTE =) V)
            (TURNCAR)))
        (SETQ VELO (CDR VELO)) ))))
    (OR MEM (PROGN (TURNCAR) (TURNCAR) (TURNCAR) ))
                       ))
(de ELLISEVOL (LIS)
    (PROG (COORD FUNCTIONS CONSTANTS EMATRIX METSUBS SIMPLSUBS NOPRINT
           STOP TENSORS DATASUBS IE AGAM GAM RM RC RINV
           FUNNAMES SYMBOLS UPIE LPOWER UPOWER WORKARR WV LIND LIJ LIJK
           LIJKL LAB LABC LABCD MESS MARKERS LMARGIN CLOCK
           VELO EXPA ATIDA VTIDA ACCE SHEAR ROT ELWEYL
           MAGWEYL VMATRIX UVELO LVELO METRIC INVMETRIC CHRIS UACCE
           LACCE ROTDD ROTDU SHEARDD SHEARDU PROJDD PROJDU DETEM OUTINP)
    (MAPC (OBLIST) (FUNCTION RESETVARS))
    (SETQ CLOCK (TIME))
    (SETQ RMARGIN 72)
    (SETQ LMARGIN  8)
% LMARGIN IS THE MARGIN FOR CONTINUATION LINES ONLY
    (SETQ LIND (LIST 0 1 2 3))
    (SETQ LIJ (LIST NIL NIL))
    (SETQ LIJK (LIST NIL NIL NIL))
    (SETQ LIJKL (LIST NIL NIL NIL NIL))
    (SETQ LAB (LIST NIL NIL))
    (SETQ LABC (LIST NIL NIL NIL))
    (SETQ LABCD (LIST NIL NIL NIL NIL))
    (ELLISINIT LIS 16)
    (RPLACD LIS NIL)
    (SETQ RC (GENSYM))
    (MKARRAY RC (LIST 4 4))
    (INVAR EMATRIX 4)
    (AND (EQ STOP (QUOTE DETERMINANT)) (GO END))
    (UPANDTRANS)
    (AND (EQ STOP (QUOTE IE)) (GO END))
    (MAKEVELO)
    (MAKEMETRIC)
    (MAKEINVMETRIC)
    (OR (AGAMMA) (GO END))
    (AND (EQ STOP (QUOTE AGAMMA)) (GO END))
    (GAMMA)
    (AND (EQ STOP (QUOTE GAMMA)) (GO END))
    (MAKECHRISTOFFEL)
    (AND (EQ STOP (QUOTE CHRISTOFFEL)) (GO END))
    (MAKETIDAL (QUOTE LVELO))
    (MAKEACCE)
    (AND (MEMQ STOP (QUOTE (LACCE UACCE))) (GO END))
    (MAKEROT)
    (AND (MEMQ STOP (QUOTE (ROTDD ROTDU ROTATION))) (GO END))
    (MAKESHEAR)
    (AND (MEMQ STOP (QUOTE (SHEARDD SHEARDU SHEAR))) (GO END))
    (MAKETIDAL (QUOTE LACCE))
    (OR (MEMQ (QUOTE ROTCONS) NOPRINT) (MAKEROTCONS))
    (AND (EQ STOP (QUOTE ROTCONS)) (GO END))
    (OR (MEMQ (QUOTE SHEARCONS) NOPRINT) (MAKESHEARCONS))
    (AND (EQ STOP (QUOTE SHEARCONS)) (GO END))
    (OR (MEMQ (QUOTE ROTEVOL) NOPRINT) (MAKEROTEVOL))
    (AND (EQ STOP (QUOTE ROTEVOL)) (GO END))
    (OR (RIEMANN) (GO END))
    (AND (EQ STOP (QUOTE RIEMANN)) (GO END))
    (OR (RICCI) (GO END))
    (AND (MEMQ STOP (QUOTE (RICCI CURVATURE EINSTEIN))) (GO END))
    (OR (MEMQ (QUOTE RAYCHAUDHURI) NOPRINT) (MAKERAYCH))
    (AND (EQ STOP (QUOTE RAYCHAUDHURI)) (GO END))
    (WEYL)
    (COMPLETE)
    (MAKELWEYL)
    (AND (EQ STOP (QUOTE ELWEYL)) (GO END))
    (OR (MEMQ (QUOTE SHEAREVOL) NOPRINT) (MAKESHEAREVOL))
    (AND (EQ STOP (QUOTE SHEAREVOL)) (GO END))
    (MAKEMAGWEYL)
    (AND (EQ STOP (QUOTE MAGWEYL)) (GO END))
    (OR (MEMQ (QUOTE MAGCONS) NOPRINT) (MAKEMAGCONS))
 END (LINELENGTH 72)
    (TERPRI) (TERPRI)
    (MESSAGE (QUOTE ("I REALLY LIKED THIS!" "CAN I HAVE MORE ?"
                                           "  PLEASE ?!?")) T)
    (TERPRI)
    (MESSAGE (QUOTE "END OF WORK") T)
    (MESSAGE (LIST (QUOTE "RUN TIME =") (PLUS (TIME) (MINUS CLOCK))
                   (QUOTE MSEC)) T)
     ))
